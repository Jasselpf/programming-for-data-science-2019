<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Programming for Data Science</title>
<meta name="author" content="Adolfo De Unánue"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="http://cdn.jsdelivr.net/reveal.js/3.0.0/css/reveal.css"/>

<link rel="stylesheet" href="http://cdn.jsdelivr.net/reveal.js/3.0.0/css/theme/black.css" id="theme"/>

<link rel="stylesheet" href="./css/slides.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'http://cdn.jsdelivr.net/reveal.js/3.0.0/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<meta name="description" content="Programación para ciencia de datos.">

          <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic,700italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
          <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:400,700' rel='stylesheet' type='text/css'>
          <style type='text/css'>
             body {
                font-family: 'Source Sans Pro', sans-serif;
             }
             pre, code {
                font-family: 'Source Code Pro', monospace;
             }
          </style>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide">
<h1 class="title">Programming for Data Science</h1><h2 class="author">Adolfo De Unánue</h2><h2 class="date">2019</h2><p class="date">Created: 2019-11-09 Sat 04:00</p>
</section>
<section id="table-of-contents-section">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#/slide-orgdbd2ad0"><i>Lectures</i></a></li>
</ul>
</div>
</div>
</section>
<section>
<section id="slide-orgdbd2ad0">
<h2 id="orgdbd2ad0"><i>Lectures</i></h2>
</section>
</section>
<section>
<section id="slide-org5cca76c">
<h3 id="org5cca76c">Licencia</h3>
<p>
Este trabajo se encuentra bajo la Licencia de
</p>

<p>
<b>Creative Commons</b>
</p>

<p>
<b>Attribution ShareAlike 4.0</b>
</p>

<p>
<b>International License.</b>
</p>

<p>
Para ver una copia de esta licencia, Visita:
<a href="http://creativecommons.org/license/by-sa/4.0/">http://creativecommons.org/license/by-sa/4.0/</a>
</p>


</section>
</section>
<section>
<section id="slide-org46e2e24">
<h3 id="org46e2e24">Introducción</h3>
</section>
<section id="slide-org6c7547b">
<h4 id="org6c7547b">Una encuesta rápida</h4>

</section>
<section id="slide-org28e1667">
<h4 id="org28e1667"><i>Data science</i> es &#x2026;</h4>
<form><ul>
<li>&#x2026; acerca de datos</li>
<li>&#x2026; utilizar el método científico</li>
<li>&#x2026; soportar la toma de decisiones</li>
<li>&#x2026; aumentar la inteligencia</li>

</ul></form>

</section>
<section id="slide-org993c8e3">
<h4 id="org993c8e3">El científico de datos</h4>
<form><ul>
<li>No es acerca de   <code>R</code> o <code>python</code> únicamente</li>

<li>No es acerca de <i>machine learning</i> únicamente</li>

<li>El científico de datos <i>crea</i> <b>producto de datos</b>.</li>

</ul></form>

</section>
<section id="slide-orge85804d">
<h4 id="orge85804d">Productos de datos</h4>
<form><ul>
<li>Es un sistema tecno-social que procesa datos de sobre un sistema
generador de los mismos para aumentar la inteligencia o capacidades
de acción de un agente externo al sistema.</li>

</ul></form>


</section>
<section id="slide-orgd624868">
<h4 id="orgd624868">Disminución del <i>dolor</i></h4>
<p>
Cualquier barrera, impedancia entre tu cerebro y los datos hará tu
trabajo menos efectivo y te causará mucho dolor.
</p>

<p>
Tener las herramientas adecuadas, saber que esas herramientas existen
y conocer cómo y cuándo utilizarlas es lo que distingue a una persona
experta.
</p>


</section>
<section id="slide-orgdb15c00">
<h4 id="orgdb15c00">Filosóficamente: <i>Dataísmo</i></h4>
<form><ul>
<li><a href="https://aeon.co/ideas/believing-without-evidence-is-always-morally-wrong">Believing without evidence is always morally wrong</a>,Francisco Mejía
Uribe, Aeon (2018)</li>
<li><a href="https://www.nytimes.com/2013/02/05/opinion/brooks-the-philosophy-of-data.html">The Philosophy of Data</a>, David Brooks,The New York Times (2013)</li>
<li><a href="http://dougengelbart.org/content/view/138">Augmenting Human Intellect: A Conceptual Framework </a>Douglas C. Engelbart (1962)</li>

</ul></form>



</section>
<section id="slide-orgc48e7c0">
<h4 id="orgc48e7c0">Filosóficamente: <i>Dataísmo</i></h4>
<blockquote>
<p>
A <b>Dataist</b> is someone that trusts Big
Data (above) and computer algorithms, in preference to human
knowledge and wisdom.
</p>

<p>
<b>Homo Deus: A Brief History of Tomorrow</b>. Yuval Noah Harare (2017)
</p>
</blockquote>


</section>
</section>
<section>
<section id="slide-cli">
<h3 id="cli">Línea de comandos</h3>
</section>
<section id="slide-org3bd3bc2">
<h4 id="org3bd3bc2">La computadora</h4>
<p>
Las computadoras sólo hacen cuatro cosas:
</p>

<form><ul>
<li>Ejecutan programas</li>
<li>Almacenan datos</li>
<li>Se comunican entre sí para hacer las cosas recién mencionadas.</li>
<li>Interactúan con nosotros.
<form><ul>
<li>La interacción puede ser gráfica (como están acostumbrados)
conocida también como <b>GUI</b> (<i>Graphical User Interface</i>) vía el
ratón u otro periférico, o desde la línea de comandos, llamada
como <b>CLI</b> (<i>Command Line Interface</i>).</li>

</ul></form></li>

</ul></form>

</section>
<section id="slide-orga4a5251">
<h4 id="orga4a5251">¿Por qué?</h4>
<p>
En muchas ocasiones, se verán en la necesidad de responder muy rápido y
en una etapa muy temprana del proceso de <b>big data</b> . Las peticiones
regularmente serán cosas muy sencillas, como estadística univariable y es
aquí donde es posible responder con las herramientas mágicas de UNIX.
</p>


</section>
<section id="slide-orgfe3ea8d">
<h4 id="orgfe3ea8d">Línea de comandos</h4>
<p>
La línea de comandos es lo que estará entre nosotros y la computadora
casi todo el tiempo en este curso. De hecho, una lectura obligada<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup> es
<a href="http://faculty.georgetown.edu/irvinem/theory/Stephenson-CommandLine-1999.pdf">In the beginning&#x2026;was de command line</a>
de <b>Neal Stephenson</b>, el escritor de
<a href="https://play.google.com/store/books/details/Neal_Stephenson_Cryptonomicon?id=dwAwSzmTHNEC"><b>Criptonomicon</b></a><sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>.
</p>


<p>
La <b>CLI</b> es otro programa más de la computadora y su función es
ejecutar otros comandos. El más popular es <code>bash</code>, que es un acrónimo
de <b>Bourne again shell</b>. Aunque en esta clase también usaremos <code>zsh</code><sup><a id="fnr.3" class="footref" href="#fn.3">3</a></sup>.
</p>

</section>
<section id="slide-orgea43c82">
<h4 id="orgea43c82">Archivos y directorios</h4>
<p>
La computadora guarda la información de una manera ordenada. El
sistema encargado de esto es el <code>file system</code>, el cual es básicamente un árbol
de información<sup><a id="fnr.4" class="footref" href="#fn.4">4</a></sup> que guarda los datos en
una abstracción que llamamos <b>archivos</b> y ordena los archivos en
<b>carpetas</b> o <b>directorios</b>, los cuales a su vez pueden contener otros
<b>directorios</b>.
</p>

<div class="info">
<p>
<b>TODO</b> en los sistemas operativos <code>*nix</code> (como Unix, GNU/Linux,
 FreeBSD, MacOS, etc)  es un <i>archivo</i>.
</p>

</div>


<p>
Muchos de los comandos del <b>CLI</b> o <code>shell</code> tienen que ver con la
manipulación del <code>file system</code>.
</p>

</section>
<section id="slide-org0275b7f">
<h4 id="org0275b7f">Filosofía UNIX</h4>
<p>
Creada originalmente en 1978 por <b>Doug McIlroy</b>, la filosofía de UNIX es
un acercamiento al diseño de software que enaltece el software modular
y minimalista.
</p>

<p>
Han existido varias adaptaciones<sup><a id="fnr.5" class="footref" href="#fn.5">5</a></sup>, pero la que más me gusta es la de
<b>Peter H. Salus</b>,
</p>

<p>
Es importante tener estos principios en mente, ya que ayuda a enmarcar
los conceptos que siguen.
</p>

<blockquote>
<form><ul>
<li>Escribe programas que hagan una cosa y que la hagan bien</li>
<li>Escribe programas que puedan trabajar en conjunto</li>
<li>Escribe programas que puedan manipular <i>streams</i> de texto, ya que
el texto es la interfaz universal.</li>

</ul></form>
</blockquote>




</section>
<section id="slide-orgb73e4e6">
<h4 id="orgb73e4e6">Conocer los alrededores</h4>
<div class="outline-text-4" id="text-orgb73e4e6">
</div>
<ul class="org-ul">
<li><a id="org9384453"></a>Navegación en la terminal<br />
<p>
Moverse rápidamente en la <b>CLI</b> es de vital importancia. Teclea en tu <i>terminal</i>
</p>

<div class="org-src-container">

<pre  class="src src-shell">Anita lava la tina
</pre>
</div>

<p>
Y ahora intenta lo siguiente:
</p>

<form><dl>
<dt><code>Ctrl + a</code></dt><dd>Inicio de la línea</dd>
<dt><code>Ctrl + e</code></dt><dd>Fin de la línea</dd>
<dt><code>Ctrl + r</code></dt><dd>Buscar hacia atrás<sup><a id="fnr.6" class="footref" href="#fn.6">6</a></sup></dd>
<dt><code>Ctrl + b</code></dt><dd>Mueve el cursor hacia atrás una letra a la vez</dd>
<dt><code>Alt + b</code></dt><dd>Mueve el cursor hacia atrás una palabra a la vez</dd>
<dt><code>Ctrl + f</code></dt><dd>Mueve el cursor hacia adelante una letra a la vez</dd>
<dt><code>Alt + f</code></dt><dd>Mueve el cursor hacia adelante una palabra a la vez</dd>

</dl></form>

</section>
<section>

<form><dl>
<dt><code>Ctrl + k</code></dt><dd>Elimina el resto de la línea (en realidad corta y pone en el búfer circular)</dd>
<dt><code>Ctrl + y</code></dt><dd>Pega la último del búfer.</dd>
<dt><code>Alt  + y</code> </dt><dd>Recorre el búfer circular.</dd>
<dt><code>Ctrl + d</code></dt><dd>Cierra la terminal</dd>
<dt><code>Ctrl + z</code></dt><dd>Manda a <i>background</i> el programa que se está ejecutando</dd>
<dt><code>Ctrl + c</code></dt><dd>Intenta cancelar</dd>
<dt><code>Ctrl + l</code></dt><dd>Limpia la pantalla</dd>

</dl></form>

</section>
<section>

<div class="warning">
<p>
Estas combinaciones de teclas (<i>keybindings</i>) son universales. Te
recomiendo que las practiques y configures tus otras herramientas con
estos mismas combinaciones, por ejemplo <a href="https://support.rstudio.com/hc/en-us/articles/210928128-Emacs-Editor-Keybindings">RStudio</a> ó <a href="https://jupyterlab.readthedocs.io/en/stable/user/interface.html?highlight=emacs#keyboard-shortcuts">JupyterLab</a> .
</p>

</div>


<div class="question">
<p>
¿Qué hacen las siguientes combinaciones?
</p>

<form><ul>
<li><code>Alt  + t</code></li>
<li><code>Alt  + d</code></li>
<li><code>Ctrl + j</code></li>
<li><code>Alt + 2 Alt + b</code></li>

</ul></form>

</div>

<p>
Para tener más información sobre los <i>bindings</i> consulta <a href="https://catonmat.net/bash-emacs-editing-mode-cheat-sheet">aquí</a>.
</p>
</li>

<li><a id="org7d3779d"></a>¿Dónde estoy?<br />
<p>
Imprime el nombre del <i>directorio</i> actual
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">pwd</span>
</pre>
</div>

<p>
Cambia el directorio un nivel arriba (a el directorio <i>padre</i> <sup><a id="fnr.7" class="footref" href="#fn.7">7</a></sup>)
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">cd</span> ..
</pre>
</div>

<p>
Si quieres regresar al directorio anterior
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">cd</span> -
</pre>
</div>
</li>

<li><a id="orgd82a1e7"></a>Hogar dulce, hogar<br />
<p>
Cambia el directorio <code>$HOME</code> (tu directorio) utilizando <code>~</code>
</p>
<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">cd</span> ~
</pre>
</div>

<p>
o bien, no pasando ningún argumento
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">cd</span>
</pre>
</div>
</li>

<li><a id="orga157896"></a>¿Qué hay en mi directorio (<i>folder</i>) ?<br />
<p>
<code>ls</code> Lista los contenidos (archivos y directorios) en el
directorio actual, pero no los archivos <i>ocultos</i>.
</p>

<div class="org-src-container">

<pre  class="src src-shell">ls
</pre>
</div>

<p>
Lista los contenidos en formato <i>largo</i> (<code>-l</code>), muestra
  el tamańo de los archivos, fecha de último cambio y permisos
</p>
<div class="org-src-container">

<pre  class="src src-shell">ls -l
</pre>
</div>

<p>
Lista los contendios en el directorio actual y todos los
  sub-directorios en una estructura de <i>árbol</i>
</p>
<div class="org-src-container">

<pre  class="src src-shell">tree
</pre>
</div>

<p>
Límita la expansión del <i>árbol</i> a dos niveles
</p>
<div class="org-src-container">

<pre  class="src src-shell">tree -L 2
</pre>
</div>

<p>
Muestra los archivosshows file sizes (<code>-s</code>) in
  human-readable format (<code>-h</code>)
</p>
<div class="org-src-container">

<pre  class="src src-shell">tree -hs
</pre>
</div>
</li>

<li><a id="org5e428ab"></a>¿Qué hay en mi archivo?<br />
<p>
Muestra el principio (<i>head</i>) del archivo, <code>-n</code> especifica el número de líneas (<code>10</code>).
</p>

<div class="org-src-container">

<pre  class="src src-shell">head -n10 $<span style="color: #455A64;">f</span>
</pre>
</div>

<p>
Muestra la final (<i>tail</i>) del archivo.
</p>
<div class="org-src-container">

<pre  class="src src-shell">tail -n10 $<span style="color: #455A64;">f</span>
</pre>
</div>

<p>
Muestra la parte final del archivo
  cada segundo (usando <code>watch</code>)
</p>

<div class="org-src-container">

<pre  class="src src-shell">tail -n10 $<span style="color: #455A64;">f</span> | watch -n1
</pre>
</div>


<p>
"seguir" (<i>follows</i>) (<code>-f</code>) la parte final del archivo, cada vez que hay cambios
</p>

<div class="org-src-container">

<pre  class="src src-shell">tail -f -n10 $<span style="color: #455A64;">f</span>
</pre>
</div>

<div class="info">
<p>
Seguir archivos es útil cuando estás ejecutando un programa que guarda
    información a un archivo, por ejemplo un <i>log</i>
</p>

</div>

<p>
Cuenta las palabras, caracteres y líneas de un archivo
</p>

<div class="org-src-container">

<pre  class="src src-shell">wc $<span style="color: #455A64;">f</span>
</pre>
</div>
</li>

<li><a id="orgdd872e7"></a>¿Dónde está mi archivo?<br />
<p>
Encuentra el archivo por nombre
</p>

<div class="org-src-container">

<pre  class="src src-shell">find -name <span style="color: #6C3082;">"&lt;lost_file_name&gt;"</span> -type f
</pre>
</div>

<p>
Encuentra directorios por nombre
</p>

<div class="org-src-container">

<pre  class="src src-shell">find -name <span style="color: #6C3082;">"&lt;lost_dir_name&gt;"</span> -type d
</pre>
</div>
</li>

<li><a id="org419149e"></a><i>Wildcards</i>: Globbing<br />
<p>
La línea de comandos permite usar comodines (<i>wildcards</i>)<sup><a id="fnr.8" class="footref" href="#fn.8">8</a></sup>
para encontrar  archivos:
</p>

<p>
El primer <i>glob</i> que veremos es <code>*</code>:
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">echo</span> *
</pre>
</div>

<p>
El <code>shell</code> expandió <code>*</code> para identificarlo con todos los archivos del
directorio actual.
</p>

<p>
Obvio lo puedes usar con otros comandos, como <code>ls</code>:
Listar todos los archivos que tienen una extensión <code>txt</code>
</p>

<div class="org-src-container">

<pre  class="src src-sh">ls *.txt
</pre>
</div>

<p>
Listar todos los archivos que contienen <code>a</code> en el nombre y extensión
<code>txt</code>
</p>

<div class="org-src-container">

<pre  class="src src-sh">ls *a*.txt
</pre>
</div>

<p>
<code>*</code> no es el único carácter especial. <code>?</code> hace <i>match</i> con cualquier
carácter individual.
</p>

<p>
Listar todos los archivos que tienen 5 caracteres en el nombre:
</p>

<div class="org-src-container">

<pre  class="src src-sh">ls ?????,txt
</pre>
</div>
</li>
</ul>


</section>
<section id="slide-orgb2a994e">
<h4 id="orgb2a994e">Conectando comandos</h4>
<div class="outline-text-4" id="text-orgb2a994e">
</div>
<ul class="org-ul">
<li><a id="org374942e"></a>Entubando<br />
<p>
El símbolo  <code>|</code> (<i>pipe</i>)  “entuba” la salida de un comando al siguiente
comando. Por ejemplo:
</p>

<div class="org-src-container">

<pre  class="src src-shell">ls -la | wc -l
</pre>
</div>

<p>
La salida de <code>ls -la</code> en lugar de ser impresa en pantalla<sup><a id="fnr.9" class="footref" href="#fn.9">9</a></sup> es
enviada a <code>wc -l</code>
</p>

<p>
El siguiente ejemplo utiliza <code>grep</code> para buscar y seleccionar cadenas o patrones
</p>

<div class="org-src-container">

<pre  class="src src-shell">seq 50 | grep 3
</pre>
</div>

<p>
Veremos más sobre <code>seq</code> y <code>grep</code> más adelante.
</p>
</li>

<li><a id="orge04f2d8"></a><code>stdin</code>, <code>stdout</code> y <code>stderr</code><br />
<p>
<code>stdin</code> (entrada estándar), <code>stdout</code> (salida estándar) y <code>stderr</code>
(error estándar) son <i>canales</i> de interacción de la terminal. En tu
terminal, todos apuntan a la pantalla, pero es posible
redireccionarlos hacia otros lados.
</p>

<p>
Los tres canales están asignados a los siguientes <i>file descriptors</i><sup><a id="fnr.10" class="footref" href="#fn.10">10</a></sup>
</p>

<form><dl>
<dt><code>0</code></dt><dd><code>stdin</code>, el teclado</dd>
<dt><code>1</code></dt><dd><code>stdout</code>, la pantalla</dd>
<dt><code>2</code></dt><dd><code>stderr</code>, la pantalla</dd>

</dl></form>

<p>
Es posible redireccionar por ejemplo,  todos los mensajes de error a
un archivo
</p>

<div class="org-src-container">

<pre  class="src src-shell">rm este_archivo_no_existe 2&gt; error.txt
</pre>
</div>


<p>
Si quieres ignorar los errores, puedes mandarlos a un agujero negro<sup><a id="fnr.11" class="footref" href="#fn.11">11</a></sup> estándar, i.e. <code>/dev/null</code>:
</p>

<div class="org-src-container">

<pre  class="src src-shell">algun_comando 2&gt; /dev/null
</pre>
</div>

<p>
o apuntar <code>stdout</code> y <code>stderr</code> al mismo lado (configuración por
<i>default</i>)
</p>

<div class="org-src-container">

<pre  class="src src-shell">algun_comando 2&gt;&amp;1
</pre>
</div>
</li>

<li><a id="org670c605"></a>Redireccionando <i>hacia</i><br />
<p>
Los símbolos <code>&gt;</code>, <code>&gt;&gt;</code> Redireccionan la salida de los comandos a un
sumidero (<i>sink</i>), e.g. un archivo, o la pantalla o la impresora.
</p>

<p>
La salida de <code>ls</code> se guarda en el archivo <code>prueba.bat</code>.
</p>

<div class="org-src-container">

<pre  class="src src-shell">ls &gt;&gt; prueba.dat
</pre>
</div>

<p>
Similar al ejemplo anterior
</p>

<div class="org-src-container">

<pre  class="src src-shell">seq 10 &gt; numeros.txt
</pre>
</div>


<div class="question">
<p>
¿Cuál es la diferencia?
</p>

<p>
<b>TIP</b>: Ejecuta varias veces los ejemplos anteriores
</p>

</div>
</li>

<li><a id="org127f03b"></a>Redireccionando <i>desde</i><br />
<p>
<code>&lt;</code> Redirecciona desde el archivo
</p>

<div class="org-src-container">

<pre  class="src src-sh">sort &lt; prueba.dat <span style="color: #795548;"># </span><span style="color: #795548;">A la l&#237;nea de comandos acomoda con sort,</span>
sort &lt; prueba.dat &gt; prueba_sort.dat <span style="color: #795548;"># </span><span style="color: #795548;">Guardar el sort a un archivo.</span>
</pre>
</div>

<p>
Incluso puedes hacer
</p>

<div class="org-src-container">

<pre  class="src src-shell">&lt; prueba.dat wc -l
</pre>
</div>

<div class="info">
<p>
Esto suena muy similar a
</p>

<div class="org-src-container">

<pre  class="src src-shell">cat prueba.dat | wc -l
</pre>
</div>

<p>
<code>&lt; prueba.dat wc -l</code> es más eficiente, ya que no está generando
un subproceso (lo cual puede ser muy importante en procesamiento intensivo.
</p>

</div>
</li>
</ul>


</section>
<section id="slide-org6214815">
<h4 id="org6214815">Algunos comandos útiles</h4>
<div class="outline-text-4" id="text-org6214815">
</div>
<ul class="org-ul">
<li><a id="org397b7a0"></a>seq<br />
<p>
Genera secuencias de números
</p>

<div class="org-src-container">

<pre  class="src src-sh">seq 5
</pre>
</div>

<p>
La sintaxis es: <code>seq inicio step final</code>. Por ejemplo
</p>

<div class="org-src-container">

<pre  class="src src-sh">seq 1 2 10
</pre>
</div>

<p>
genera la secuencia de 1 al 10 de dos en dos.
</p>

<p>
Usando otro separador (<code>-s</code>) que no sea es caracter de espacio
</p>
<div class="org-src-container">

<pre  class="src src-sh">seq -s <span style="color: #6C3082;">'|'</span> 10
</pre>
</div>

<p>
Agregando <i>padding</i>
</p>

<div class="org-src-container">

<pre  class="src src-sh">seq -w 1 10
</pre>
</div>
</li>

<li><a id="org2efa42b"></a>tr<br />
<p>
Cambia, reemplaza o borra caracteres del <code>stdin</code> al <code>stdout</code>
</p>

<div class="org-src-container">

<pre  class="src src-sh"><span style="color: #795548;">echo</span> <span style="color: #6C3082;">"Hola mi nombre es Adolfo De Un&#225;nue"</span>  | tr <span style="color: #6C3082;">'[:upper]'</span> <span style="color: #6C3082;">'[:lower]'</span>
</pre>
</div>

<div class="org-src-container">

<pre  class="src src-sh"><span style="color: #795548;">echo</span> <span style="color: #6C3082;">"Hola mi nombre es Adolfo De Un&#225;nue"</span>  | tr -d <span style="color: #6C3082;">' '</span>
</pre>
</div>

<div class="org-src-container">

<pre  class="src src-sh"><span style="color: #795548;">echo</span> <span style="color: #6C3082;">"Hola mi nombre es Adolfo De Un&#225;nue"</span>  | tr -s <span style="color: #6C3082;">' '</span> <span style="color: #6C3082;">'_'</span>
</pre>
</div>
</li>

<li><a id="orge896ed4"></a>wc<br />
<p>
<code>wc</code> significa <i>word count</i>. Este comando cuenta las
palabras,renglones, bytes en el archivo.
</p>

<p>
En nuestro caso nos interesa la bandera <code>-l</code> la cual sirve para contar líneas.
</p>

<div class="org-src-container">

<pre  class="src src-sh">seq 30 | grep 3 | wc -l
</pre>
</div>
</li>

<li><a id="org8c99fe9"></a>head, tail<br />
<p>
<code>head</code> y <code>tail</code> sirven para explorar visualmente las primeras diez
(<i>default</i>) o las últimas diez (<i>default</i>) renglones del archivo,
respectivamente.
</p>


<div class="org-src-container">

<pre  class="src src-shell">head UFO-Dic-2014.tsv

tail -3 UFO-Dic-2014.tsv
</pre>
</div>
</li>

<li><a id="orgf8dfc69"></a>cat<br />
<p>
<code>cat</code> concatena archivos y/o imprime al <code>stdout</code>
</p>

<div class="org-src-container">

<pre  class="src src-sh"><span style="color: #795548;">echo</span> <span style="color: #6C3082;">'Hola mundo'</span> &gt;&gt; test

<span style="color: #795548;">echo</span> <span style="color: #6C3082;">'Adios mundo cruel'</span> &gt;&gt; test

cat test

rm test
</pre>
</div>

</section>
<section>

<p>
Podrías hacer lo mismo, sin utilizar <code>echo</code>
</p>

<div class="org-src-container">

<pre  class="src src-shell">cat &gt;&gt; test

<span style="color: #795548;"># </span><span style="color: #795548;">Teclea Hola mundo</span>
<span style="color: #795548;"># </span><span style="color: #795548;">Teclea Adios mundo cruel</span>

<span style="color: #795548;"># </span><span style="color: #795548;">Ctrl-C</span>
</pre>
</div>

</section>
<section>

<p>
También podemos concatenar archivos
</p>

<div class="org-src-container">

<pre  class="src src-sh">cat UFO-Nov-2014.tsv UFO-Dic-2014.tsv  &gt; UFO-Nov-Dic-2014.tsv
wc -l UFO-Nov-Dic-2014.tsv
</pre>
</div>

</section>
<section>

<p>
En el siguiente ejemplo redireccionamos al <code>stdin</code> el archivo como
entrada del <code>wc -l</code> sin generar un nuevo proceso
</p>


<div class="org-src-container">

<pre  class="src src-shell">&lt; numeros.txt wc -l
</pre>
</div>
</li>



<li><a id="org1c6b1c6"></a>split<br />
<p>
<code>split</code> hace la función contraria de <code>cat</code>, divide archivos.
Puede hacerlo por tamaño (bytes, <code>-b</code>) o por líneas (<code>-l</code>).
</p>

<div class="org-src-container">

<pre  class="src src-sh">split -l 500 UFO-Nov-Dic-2014.tsv
wc -l UFO-Nov-Dic-2014.tsv
</pre>
</div>
</li>

<li><a id="orga6b194f"></a>cut<br />
<p>
Con <code>cut</code> podemos dividir el archivo pero por columnas.
Las columnas puede estar definidas como campo (<code>-f</code>, <code>-d</code>), carácter (<code>-c</code>) o bytes (<code>-b</code>).
</p>

<p>
Creemos unos datos de prueba
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">echo</span> <span style="color: #6C3082;">"Adolfo|1978|F&#237;sico"</span> &gt;&gt; prueba.psv
<span style="color: #795548;">echo</span> <span style="color: #6C3082;">"Paty|1984|Abogada"</span> &gt;&gt; prueba.psv
</pre>
</div>

<p>
Ejecuta los siguientes ejemplos, ¿Cuál es la diferencia?
</p>

<div class="org-src-container">

<pre  class="src src-sh">cut -d&#8217;|&#8217; -f1 prueba.psv
cut -d&#8217;|&#8217; -f1,3 prueba.psv
cut -d&#8217;|&#8217; -f1-3 prueba.psv
</pre>
</div>
</li>



<li><a id="orgc03caa7"></a>uniq<br />
<form><ul>
<li><code>uniq</code> Identifica aquellos renglones consecutivos que son iguales.</li>
<li><code>uniq</code> puede contar (<code>-c</code>), eliminar (<code>-u</code>), imprimir sólo las
duplicadas (<code>-d</code>), etc.</li>

</ul></form>
</li>

<li><a id="org109ef59"></a>sort<br />
<form><ul>
<li><code>sort</code> Ordena el archivo, es muy poderoso, puede ordenar por</li>

</ul></form>
<p>
columnas (<code>-k</code>), usar ordenamiento numérico (<code>-g</code>, <code>-h</code>, <code>-n</code>), mes
(<code>-M</code>), random (<code>-r</code>) etc.
</p>


<div class="org-src-container">

<pre  class="src src-sh">sort -t <span style="color: #6C3082;">","</span> -k 2  UFO-Nov-Dic-2014.tsv
</pre>
</div>
</li>


<li><a id="org1ba9ece"></a>uniq y sort<br />
<form><ul>
<li>Combinados podemos tener un <code>group by</code>:</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-sh"><span style="color: #795548;"># </span><span style="color: #795548;">Group by por estado y fecha</span>
cat UFO-Dic-2014.tsv |<span style="color: #6C3082;">\</span>
    cut -d$<span style="color: #6C3082;">'\t'</span> -f1,3 |<span style="color: #6C3082;">\</span>
    tr <span style="color: #6C3082;">'\t'</span> <span style="color: #6C3082;">' '</span> |<span style="color: #6C3082;">\</span>
    cut-d<span style="color: #6C3082;">' '</span> -f1,3 |<span style="color: #6C3082;">\</span>
    sort -k 2 -k 1 |<span style="color: #6C3082;">\</span>
    uniq -c |<span style="color: #6C3082;">\</span>
    sort -n -r -k 1 |<span style="color: #6C3082;">\</span>
    head
</pre>
</div>
</li>


<li><a id="orgac8da70"></a>Hacer varias cosas a la vez<br />
<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;"># </span><span style="color: #795548;">Ejecuta un servidor web en el puerto 8888</span>
python -m http.server 8888
</pre>
</div>

<p>
Ve a la dirección mostrada en la terminal en tu navegador
</p>

<p>
Si presionas <code>Ctrl+z</code> <i>suspenderás</i> la ejecución de ese programa, pero
no será <b>cancelado</b>. Observa que el <code>shell</code> te devolvió el control de
la terminal. Trata de ver de nuevo la lista de archivos en el
navegador &#x2026; y el navegador se quedará en <i>Waiting for 0.0.0.0 &#x2026;</i>
</p>

</section>
<section>

<p>
Regresa a la terminal y ejecuta
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">jobs</span>
</pre>
</div>

<p>
<code>jobs</code> muestra que programas están ejecutándose
y su estatus. En particular, el servidor <code>http</code> está detenido.
</p>

</section>
<section>

<p>
Para activarlo usa
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">fg</span>
</pre>
</div>

<p>
<code>fg</code> significa <i>foreground</i>. Interrumpe la ejecución con <code>Ctrl+c</code>.
</p>

<p>
Si quieres ejecutar el servidor y <b>no</b> bloquear la terminal agrega <code>&amp;</code>
al final.
</p>

<div class="org-src-container">

<pre  class="src src-shell">python -m http.server 8888 &amp;
</pre>
</div>

<p>
De esta manera el servidor está ejecutándose en el <i>background</i>.
</p>

</section>
<section>

<div class="warning">
<p>
Es importante saber que estos procesos o <i>jobs</i> estarán ejecutándose
mientras tu sesión esté activa. Si te desconectas los procesos serán
terminados.
</p>

<p>
Más adelante veremos como solucionar esto.
</p>

</div>
</li>
</ul>

</section>
<section id="slide-orge0dbbfd">
<h4 id="orge0dbbfd">Descargar datos</h4>
<p>
Es posible hacer peticiones de HTTP (<i>http requests</i>)<sup><a id="fnr.12" class="footref" href="#fn.12">12</a></sup> desde la línea
de comandos.
</p>

<p>
El comando para hacerlo es <code>curl</code>.
</p>

<div class="org-src-container">

<pre  class="src src-shell">curl http://www.gutenberg.org
</pre>
</div>

<div class="info">
<p>
Si hay redirecciones puedes usar <code>-L</code> para seguir la redirección (por
ejemplo en los casos donde hay un <i>url shortener</i>, como <code>bit.ly</code>.
</p>

</div>

</section>
<section>

<p>
La respuesta (<i>response</i>) incluye el <i>body</i> (lo que ves en el
navegador) y el <i>header</i> (metainformación sobre la petición y
respuesta). Si sólo quieres ver el <i>header</i>
</p>


<div class="org-src-container">

<pre  class="src src-shell">curl -I https://duckduckgo.com
</pre>
</div>

</section>
<section>

<p>
El <i>header</i> contiene un pedazo de información crucial:
el <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">status code</a>. El <i>status code</i> te sirve para ver el estado de la
página:
</p>

<form><ul>
<li>¿La página respondió correctamente? <code>200 OK</code></li>
<li>¿El recurso solicitado no existe? <code>404 File Not Found</code></li>
<li>etc</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell">curl -I https://duckduckgo.com 2&gt;/dev/null | head -n 1 | cut -d$<span style="color: #6C3082;">' '</span> -f2
</pre>
</div>

<p>
donde:
</p>

<form><ul>
<li><code>2&gt;/dev/null</code>, redirecciona <code>stderr</code> a un agujero negro</li>
<li><code>head -n 1</code>, lee la primera línea únicamente</li>
<li><code>cut -d$' ' -f2</code>, separa la línea usando espacios (<code>' '</code>) y toma el
segundo campo, que contiene el código de estatus <code>HTTP</code>.</li>

</ul></form>


</section>
<section id="slide-org9fe7128">
<h4 id="org9fe7128">Expresiones regulares</h4>
<blockquote>
<p>
In computing, regular expressions provide a concise and flexible means for
identifying strings of text of interest, such as particular characters, words,
or patterns of characters. Regular expressions (abbreviated as regex or
regexp, with plural forms regexes, regexps, or regexen) are written in a
formal language that can be interpreted by a regular expression processor,
a program that either serves as a parser generator or examines text and
identifies parts that match the provided specification.
</p>

<p>
Wikipedia: Regular Expressions
</p>
</blockquote>


<ul class="org-ul">
<li><a id="org528133a"></a>Regexp: Básicos<br />
<form><ul>
<li>Hay varios tipos POSIX, Perl, PHP, GNU/Emacs, etc. Nosotros nos
enfocaremos en <code>POSIX</code>.</li>

</ul></form>

<div class="warning">
<p>
Conocer que tipo de expresiones regulares estás utilizando te quitará
muchos dolores de cabeza.
</p>

<p>
Lee la documentación de tu lenguaje favorito.
</p>

</div>

<form><ul>
<li>Pensar en patrones (<i>patterns</i>).</li>
<li>Operadores básicos
<form><ul>
<li><b>OR</b>  <code>gato|gata</code> hará match con gato o gata.</li>
<li><i>Agrupamiento o precedencia de operadores</i> <code>gat(a|o)</code> tiene el mismo significado que <code>gato|gata</code>.</li>

</ul></form></li>
<li>Cuantificadores
<form><dl>
<dt><code>?</code></dt><dd>0 ó 1</dd>
<dt><code>+</code></dt><dd>uno o más</dd>
<dt><code>*</code></dt><dd>cero o más<sup><a id="fnr.13" class="footref" href="#fn.13">13</a></sup></dd>

</dl></form></li>

</ul></form>

</section>
<section>

<form><ul>
<li>Expresiones básicas
<form><dl>
<dt><code>.</code></dt><dd>Cualquier carácter.</dd>
<dt><code>[ ]</code></dt><dd>Cualquier carácter incluido en los corchetes, e.g. <code>[xyz]</code>, <code>[a-zA-Z0-9-]</code>.</dd>
<dt><code>[^ ]</code></dt><dd>Cualquier caracter individual que n esté en los corchetes, e.g. <code>[^abc]</code>. También puede indicar inicio de líınea (fuera de los corchetes.).</dd>

</dl></form></li>

</ul></form>


</section>
<section>

<form><dl>
<dt><code>\( \)</code> ó <code>( )</code></dt><dd>crea una subexpresión que luego puede ser
invocada con <code>\n</code> donde <code>n</code> es el número de la subexpresión.</dd>

<dt><code>{m,n}</code></dt><dd>Repite lo anterior un número de al menos <code>m</code> veces pero no
mayor a <code>n</code> veces.</dd>
<dt><code>\b</code></dt><dd>representa el límite de palabra.</dd>

</dl></form>
</li>


<li><a id="org0365bd5"></a>Regexp: Ejemplos<br />
<form><ul>
<li>username: <code>[a-z0-9 -]{3,16}</code></li>
<li>contraseña: <code>[a-z0-9 -]{6,18}</code></li>

<li>IP address:</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #707183;">(</span>25<span style="color: #7388d6;">[</span>0-5<span style="color: #7388d6;">]</span>|2<span style="color: #7388d6;">[</span>0-4<span style="color: #7388d6;">][</span>0-9<span style="color: #7388d6;">]</span>|<span style="color: #7388d6;">[</span>01<span style="color: #7388d6;">]</span>?<span style="color: #7388d6;">[</span>0-9<span style="color: #7388d6;">][</span>0-9<span style="color: #7388d6;">]</span>?<span style="color: #6C3082;">\.</span><span style="color: #707183;">){</span>3<span style="color: #707183;">}(</span>25<span style="color: #7388d6;">[</span>0-5<span style="color: #7388d6;">]</span>|2<span style="color: #7388d6;">[</span>0-4<span style="color: #7388d6;">][</span>0-9<span style="color: #7388d6;">]</span>|<span style="color: #7388d6;">[</span>01<span style="color: #7388d6;">]</span>?<span style="color: #7388d6;">[</span>0-9<span style="color: #7388d6;">][</span>0-9<span style="color: #7388d6;">]</span>?<span style="color: #707183;">)</span>
</pre>
</div>
</li>

<li><a id="orgf0e30ba"></a>Regexp: Expresiones de caracteres<br />
<form><ul>
<li><code>[:digit:]</code> Dígitos del 0 al 9.</li>
<li><code>[:alnum:]</code> Cualquier caracter alfanumérico 0 al 9 OR A a la Z OR a a la z.</li>
<li><code>[:alpha:]</code> Caracter alfabético A a la Z OR a a la z.</li>
<li><code>[:blank:]</code> Espacio  o TAB únicamente.</li>

</ul></form>
</li>


<li><a id="org7d13ade"></a>Regexp: ¿Quieres saber más?<br />
<form><ul>
<li><a href="http://tutorialzine.com/2014/12/learn-regular-expressions-in-20-minutes/">Learn Regular Expressions in 20 minutes</a></li>
<li><a href="http://www.codeproject.com/Articles/9099/The-Minute-Regex-Tutorial">The 30 minute regex tutorial</a></li>

</ul></form>
</li>
</ul>





</section>
<section id="slide-org445c4ae">
<h4 id="org445c4ae">Analizando datos<sup><a id="fnr.14" class="footref" href="#fn.14">14</a></sup>: Comandos avanzados</h4>
<div class="outline-text-4" id="text-org445c4ae">
</div>
<ul class="org-ul">
<li><a id="org705de04"></a>grep<br />
<p>
<code>grep</code> nos permite buscar líneas que tengan un patrón específico. Es
el equivalente a un filtro.
</p>

<p>
La sintáxis es sencilla:
</p>

<div class="org-src-container">

<pre  class="src src-shell">grep <span style="color: #707183;">[</span>banderas<span style="color: #707183;">]</span> patron <span style="color: #707183;">[</span>archivo<span style="color: #707183;">]</span>
</pre>
</div>


<p>
Por ejemplo, todos los avistamientos en California en Noviembre y
Diciembre de 2014:
</p>

<div class="org-src-container">

<pre  class="src src-shell">grep <span style="color: #6C3082;">"CA"</span> UFO-Nov-Dic-2014.tsv
</pre>
</div>

<p>
En una vuelta irónica de esta historia, ellos clasifican posibles
avistamientos como "fraudes" (<i>hoax</i>)
</p>

<div class="org-src-container">

<pre  class="src src-shell">grep <span style="color: #6C3082;">"HOAX"</span> UFO-Nov-Dic-2014.tsv
</pre>
</div>

</section>
<section>

<p>
Dos banderas importantes de <code>grep</code> son <code>-v</code> (negación/complemento):
</p>


<div class="org-src-container">

<pre  class="src src-shell">grep <span style="color: #6C3082;">"HOAX"</span> UFO-Nov-Dic-2014.tsv
grep -v <span style="color: #6C3082;">"18:"</span> UFO-Nov-Dic-2014.tsv
</pre>
</div>

<p>
y <code>-E</code> (interpretar el patrón como una regex).
</p>

<div class="org-src-container">

<pre  class="src src-shell">grep -E <span style="color: #6C3082;">"18:|19:|20:"</span> UFO-Nov-Dic-2014.tsv
grep -E <span style="color: #6C3082;">"[B|b]lue|[O|o]range"</span> UFO-Nov-Dic-2014.tsv
</pre>
</div>


</section>
<section>

<p>
Otras banderas importantes son las siguientes
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Banderas útiles de <code>grep</code></caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">bandera</th>
<th scope="col" class="org-left">significado</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>-i</code></td>
<td class="org-left">Ignora mayúsculas / minúsculas</td>
</tr>

<tr>
<td class="org-left"><code>-o</code></td>
<td class="org-left">Regresa <b>todos</b> los <i>match</i> en lugar de la línea que contiene el <i>match</i></td>
</tr>

<tr>
<td class="org-left"><code>-c</code></td>
<td class="org-left">Cuenta el resultado</td>
</tr>
</tbody>
</table>

</section>
<section>

<p>
Usando estas banderas tenemos una versión más simple que el filtrado anterior
</p>

<div class="org-src-container">

<pre  class="src src-shell"> grep -i -E <span style="color: #6C3082;">"[blue|orange]"</span> UFO-Dic-2014.tsv
</pre>
</div>


<p>
¿Por qué son diferentes los siguientes comandos?
</p>

<div class="org-src-container">

<pre  class="src src-shell"> grep -c -o -E <span style="color: #6C3082;">"[B|b]lue|[O|o]range"</span> UFO-Nov-Dic-2014.tsv  <span style="color: #795548;"># </span><span style="color: #795548;">Ejecuta una bandera a la vez</span>
</pre>
</div>

<p>
y
</p>

<div class="org-src-container">

<pre  class="src src-shell"> grep -o -E <span style="color: #6C3082;">"[B|b]lue|[O|o]range"</span> UFO-Nov-Dic-2014.tsv | sort | uniq -c
</pre>
</div>

</section>
<section>

<p>
Más diversión con expresiones regulares
</p>

<div class="org-src-container">

<pre  class="src src-shell"> grep <span style="color: #6C3082;">"\/[0-9]\{1,2\}\/"</span> UFO-Dic-2014.tsv
 grep -v <span style="color: #6C3082;">"\/[0-9]\{4\}"</span> UFO-Dic-2014.tsv
 grep -E <span style="color: #6C3082;">"([aeiou]).*\1"</span> names.txt
 <span style="color: #795548;">echo</span> <span style="color: #6C3082;">"Hola grupo &#191;C&#243;mo est&#225;n?"</span> | grep -oE <span style="color: #6C3082;">'\w+'</span>
</pre>
</div>
</li>

<li><a id="org27b3abe"></a>awk<br />
<p>
<code>awk</code> es un lenguaje de programación muy completo, orientado a
archivos de texto que vengan en columnas<sup><a id="fnr.15" class="footref" href="#fn.15">15</a></sup>
</p>

<p>
Un <i>programa</i> de <code>awk</code> consiste en una secuencia de enunciados del tipo patrón-acción:
</p>

<div class="org-src-container">

<pre  class="src src-shell">awk  <span style="color: #6C3082;">'search pattern { action statement }'</span> <span style="color: #707183;">[</span>archivo<span style="color: #707183;">]</span>
</pre>
</div>


<p>
<code>awk</code> define algunas variables especiales:
</p>
<form><dl>
<dt><code>$1,$2, $3, ...</code></dt><dd>Valores de las columnas</dd>
<dt><code>$0</code></dt><dd>toda la línea</dd>
<dt><code>FS</code></dt><dd>separador de entrada</dd>
<dt><code>OFS</code></dt><dd>separador de salida</dd>
<dt><code>NR</code></dt><dd>número de la línea actual</dd>
<dt><code>NF</code></dt><dd>número de campos en la línea<sup><a id="fnr.16" class="footref" href="#fn.16">16</a></sup></dd>

</dl></form>

</section>
<section>

<p>
Imprime la Ciudad (<code>City</code>) del avistamiento
</p>

<div class="org-src-container">

<pre  class="src src-shell">awk -F<span style="color: #6C3082;">"[\t]"</span> <span style="color: #6C3082;">'{ print $2 }'</span> UFO-Nov-2014.tsv
</pre>
</div>

<p>
Otros ejemplos:
</p>

<p>
Verificar el número de columnas en todo el archivo
</p>

<div class="org-src-container">

<pre  class="src src-shell"> awk -F<span style="color: #6C3082;">"[\t]"</span> <span style="color: #6C3082;">'{ print NF }'</span> UFO-Nov-Dic-2014.tsv <span style="color: #6C3082;">\</span>
      | sort -n | uniq
</pre>
</div>

<p>
Imprimir el número de columnas de cada renglón
</p>

<div class="org-src-container">

<pre  class="src src-shell">awk -F<span style="color: #6C3082;">"[\t]"</span> <span style="color: #6C3082;">'{ print NF ":" $0 }'</span> UFO-Nov-Dic-2014.tsv
</pre>
</div>

</section>
<section>

<p>
Es posible usar <i>tests</i> para imprimir o hacer otra operación:
</p>

<div class="org-src-container">

<pre  class="src src-shell">awk -F<span style="color: #6C3082;">"[\t]"</span> <span style="color: #6C3082;">'{ $2 = ""; print }'</span> UFO-Nov-Dic-2014.tsv
</pre>
</div>

<p>
En este ejemplo, sólo se imprimen las líneas que no contienen Ciudad
(<code>City</code>)
</p>



<div class="question">
<p>
¿Cómo verificas que estas líneas tengan 7 columnas, a pesar de no
tener ciudad?
</p>

</div>


</section>
<section>

<p>
Además de <i>tests</i> es posible usar bloques <code>if-then-else</code>:
</p>


<div class="org-src-container">

<pre  class="src src-shell">awk <span style="color: #6C3082;">'BEGIN{ FS = "\t" }; { if(NF != 7){ print &gt;&gt; "UFO_fixme.tsv"} \</span>
<span style="color: #6C3082;"> else { print &gt;&gt; "UFO_OK.tsv" } }'</span> UFO-Nov-Dic-2014.tsv
</pre>
</div>

<p>
Este es un truco que uso <b>todo</b> el tiempo para mover las líneas con
columnas de más o de menos a otro archivo.
</p>


</section>
<section>

<p>
<code>awk</code> tiene otros dos modificadores: <code>BEGIN</code> y <code>END</code> que indican
<i>cuando</i> debe de ejecutarse las instrucciones, si antes de leer el
archivo (<code>BEGIN</code>) o al terminar de leer el archivo (<code>END</code>)
</p>

<p>
Como un ejemplo sencillo, lo siguiente es equivalente a <code>wc -l</code>
</p>

<div class="org-src-container">

<pre  class="src src-shell">awk <span style="color: #6C3082;">'END { print NR }'</span>  UFO-Nov-Dic-2014.tsv
</pre>
</div>

<p>
La manera de interpretarlo es: <i>luego de leer todo el archivo</i> (<code>END</code>)
<i>imprime el número de línea</i>.
</p>

</section>
<section>

<p>
Podemos hacer operaciones con los datos en las columnas:
</p>

<div class="org-src-container">

<pre  class="src src-shell">awk <span style="color: #6C3082;">'BEGIN{ FS = "," }; {sum += $1} END {print sum}'</span> data.txt
awk -F, <span style="color: #6C3082;">'{sum1+=$1; sum2+=$2;mul+=$2*$3} END {print sum1/NR,sum2/NR,mul/NR}'</span> numbers.dat
awk -F, <span style="color: #6C3082;">'$1 &gt; max { max=$1; maxline=$0 }; END { print max, maxline }'</span> numbers.dat
</pre>
</div>



</section>
<section>

<p>
También podemos usar <i>regexs</i> como condicionales, para substituir o para
</p>

<div class="org-src-container">

<pre  class="src src-shell">awk <span style="color: #6C3082;">'/CA/ { n++ }; END { print n+0 }'</span> UFO-Nov-Dic-2014.tsv
awk <span style="color: #6C3082;">'{ sub(/FL/,"Florida"); print }'</span> UFO-Nov-Dic-2014.tsv
awk <span style="color: #6C3082;">'{ gsub(/foo/,"bar"); print }'</span> UFO-Nov-Dic-2014.tsv
awk <span style="color: #6C3082;">'/baz/ { gsub(/foo/, "bar") }; { print }'</span> UFO-Nov-Dic-2014.tsv
awk <span style="color: #6C3082;">'!/baz/ { gsub(/foo/, "bar") }; { print }'</span> UFO-Nov-Dic-2014.tsv
awk <span style="color: #6C3082;">'a != $0; { a = $0 }'</span> <span style="color: #795548;"># </span><span style="color: #795548;">Como uniq</span>
awk <span style="color: #6C3082;">'!a[$0]++'</span> <span style="color: #795548;"># </span><span style="color: #795548;">Remueve duplicados que no sean consecutivos</span>
awk -F<span style="color: #6C3082;">"[\t]"</span> <span style="color: #6C3082;">'$4 ~/Circle/'</span> UFO-Nov-Dic-2014.tsv
awk -F<span style="color: #6C3082;">"[\t]"</span> <span style="color: #6C3082;">'</span>
<span style="color: #6C3082;">    BEGIN { conteo=0;}</span>
<span style="color: #6C3082;">        $4 ~/Circle/ { conteo++; }</span>
<span style="color: #6C3082;">    END {</span>
<span style="color: #6C3082;">        print "N&#250;mero de avistamientos circulares en el dataset =",conteo;</span>
<span style="color: #6C3082;">    }'</span> UFO-Nov-Dic-2014.tsv
</pre>
</div>

</section>
<section>

<div class="warning">
<p>

</p>

<p>
Existen (al menos) 3 implementaciones de <code>awk</code>:
</p>

<form><ul>
<li><b>POSIX</b> <code>awk</code>. El estándar</li>

<li><code>gawk</code>, <b><b>GNU awk</b></b> lleno de funcionalidad, más potente y soporta archivos gigantes.</li>

<li><code>mawk</code>, <b><b>Minimal awk</b></b> tiene el mínimo de funcionalidad pero es más rápido.</li>

</ul></form>

<p>
Si estás teniendo problemas para ejecutar algo (como quedarte sin
memoria o que haya funciones que no existen) probablemente no estás
usando <code>gawk</code>. Verifica que tengas esa implementación instalada. Te
ahorrará muchos dolores de cabeza.
</p>

</div>


<p>
Para saber más consulta el manual <a href="https://www.gnu.org/software/gawk/manual/"><b>GNU awk</b> <i>Effective AWK Programming</i></a>
</p>
</li>

<li><a id="org621c7fd"></a>sed<br />
<p>
A veces queremos <i>editar</i> o cambiar el contenido de nuestros
<i>datasets</i>, por ejemplo, quizá queramos deshacernos de ciertos
renglones (e.g. <i>headers</i> repetidos) o queremos cambiar el valor de
una columna (e.g. cambiar el código <code>1</code> a <code>rojo</code>), <code>sed</code> es la
herramienta que nos ayudará a hacer esto. <code>sed</code> significa <b>stream
editor</b> . Permite editar archivos de manera automática.
</p>

<p>
<code>sed</code> lee el <b>flujo de entrada</b> hasta que encuentra
<code>\n</code>. Lo copia al <b>espacio patrón</b>, y es ahí donde se realizan las
operaciones con los datos. <code>sed</code> contiene un <b>búfer</b> que puede ser
utilizado para mantener una memoria, pero es
opcional, finalmente copia al <b>flujo de salida</b>.
</p>


<p>
Hay mucho, mucho poder en esta herramienta. La sintaxis es
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #707183;">[</span>banderas<span style="color: #707183;">]</span> comando/patr&#243;n/<span style="color: #707183;">[</span>reemplazo<span style="color: #707183;">]</span>/<span style="color: #707183;">[</span>modificador<span style="color: #707183;">]</span> <span style="color: #707183;">[</span>archivo<span style="color: #707183;">]</span>
</pre>
</div>

</section>
<section>

<p>
Iniciemos con el comando para sustituir: <code>s</code>.
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'s/foo/bar/'</span> data3.txt
</pre>
</div>

<p>
Si queremos guardar la salida a un archivo, no olvides que hay redirecciones
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'s/foo/bar/'</span> &lt; data3.txt &gt; data4.txt
<span style="color: #795548;"># </span><span style="color: #795548;">O tambi&#233;n &lt; data3.txt sed 's/foo/bar/'  &gt; data4.txt</span>
</pre>
</div>


</section>
<section>

<p>
Nota lo que sucede en el siguiente ejemplo:
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'s/uno/UNO/'</span> &lt; texto.txt
</pre>
</div>

<p>
este es el funcionamiento por omisión de <code>sed</code>.
</p>

<div class="info">
<p>

</p>

<p>
Estamos usando <code>/</code>  como separador ya que es el que usa <code>vim</code> o <code>man</code>
(¿Recuerdas el primer ejercicio?), pero en realidad puedes usar
cualquier otro caracter:
</p>

<p>
Guión bajo (<i>underscore</i>)
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'s_uno_UNO_'</span> &lt; texto.txt
</pre>
</div>

<p>
o también dos puntos (<code>:</code>)
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'s:uno:UNO:'</span> &lt; texto.txt
</pre>
</div>

<p>
son opciones relativamente populares.
</p>

</div>


</section>
<section>


<p>
Para hacer la sustitución global (i.e. todas las ocurrencias del
patrón en la línea), usamos el modificador <code>g</code>
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'s/uno/UNO/g'</span> &lt; texto.txt
</pre>
</div>

<p>
También es posible hacerlo en <i>algunas</i> partes del archivo,
especificando la líneas. Por ejemplo en los siguientes ejemplo
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'3s/foo/bar/'</span>  data3.txt <span style="color: #795548;"># </span><span style="color: #795548;">S&#243;lo la tercera linea</span>
sed <span style="color: #6C3082;">'3!s/foo/bar/'</span>  data3.txt <span style="color: #795548;"># </span><span style="color: #795548;">Excluye la tercera l&#237;nea</span>
sed <span style="color: #6C3082;">'2,3s/foo/bar/'</span> data3.txt <span style="color: #795548;"># </span><span style="color: #795548;">Con rango</span>
</pre>
</div>

<p>
Si observas bien, el número de línea funciona como un <i>filtro</i>. Es
posible extender la idea y usar <i>patrones</i>: Sustituir globalmente
<i>foo</i> por <i>bar</i> en las líneas que tengan <code>123</code>.
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'/123/s/foo/bar/g'</span>  data3.txt
</pre>
</div>

</section>
<section>

<p>
Podemos mezclar ambas ideas y seleccionar partes del archivo usando
rangos y patrones
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed <span style="color: #6C3082;">'/abc/,/456/s/foo/BAR/g'</span>  data3.txt
</pre>
</div>



</section>
<section>

<p>
Otro modificadores importantes son <code>d</code> (<i>delete</i>) y <code>p</code> (<i>print</i>)<sup><a id="fnr.17" class="footref" href="#fn.17">17</a></sup>
</p>

<div class="org-src-container">

<pre  class="src src-shell"> sed -n <span style="color: #6C3082;">'2,3p'</span> data3.txt  <span style="color: #795548;"># </span><span style="color: #795548;">Imprime s&#243;lo las l&#237;neas de la 2 a la 3</span>
 sed -n <span style="color: #6C3082;">'$p'</span> <span style="color: #795548;"># </span><span style="color: #795548;">Imprime la &#250;ltima l&#237;nea</span>
 sed <span style="color: #6C3082;">'/abc/,/-foo-/d'</span> data3.txt <span style="color: #795548;"># </span><span style="color: #795548;">Elimina todas las l&#237;neas entre "abc" y "-foo-"</span>
 sed 1d data2.txt <span style="color: #795548;"># </span><span style="color: #795548;">Elimina la primera l&#237;nea del archivo</span>
</pre>
</div>


</section>
<section>

<p>
En todos los ejemplos anteriores, <code>sed</code> leía la fuente y emitía el
resultado modificado a <code>stdout</code>.  De esta manera, la fuente original no
es modificada. La manera de hacerlo <i>in place</i> con la bandera <code>-i</code>.
</p>

<div class="org-src-container">

<pre  class="src src-shell">sed -i 1d data2.txt  <span style="color: #795548;"># </span><span style="color: #795548;">Elimina la primera l&#237;nea del archivo de manera interactiva</span>
</pre>
</div>
</li>
</ul>



</section>
<section id="slide-org7536699">
<h4 id="org7536699"><i>Bash programming</i></h4>
<p>
La mayor parte del tiempo usaremos el <code>shell</code>, para hacer pequeños
<i>scripts</i>, pero existen ocasiones en las cuales es necesario tratar al
<code>shell</code> como un lenguaje de programación<sup><a id="fnr.18" class="footref" href="#fn.18">18</a></sup>
</p>

<ul class="org-ul">
<li><a id="org4911460"></a>Estructuras de datos<br />
<p>
Las variables son declaradas
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #455A64;">nombre</span>=<span style="color: #6C3082;">"Adolfo"</span>
</pre>
</div>

<p>
Nota que no hay espacios alrededor del signo de igual. El valor de la
variable se obtiene con el signo de dólares
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">echo</span> $<span style="color: #455A64;">nombre</span>
</pre>
</div>


<p>
Es posible definir variables que no sean escalares, llamadas arreglos (<code>arrays</code>).
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #455A64;">array</span>=<span style="color: #707183;">(</span>abc 123 def <span style="color: #6C3082;">"programming for data science"</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Para acceder a elementos en el arreglo usa la posición e.g. <code>3</code>:
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">echo</span> $<span style="color: #707183;">{</span><span style="color: #455A64;">array</span><span style="color: #7388d6;">[</span>3<span style="color: #7388d6;">]</span><span style="color: #707183;">}</span>
</pre>
</div>

<p>
Tambien es posible usar <i>globs</i>
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">echo</span> $<span style="color: #707183;">{</span><span style="color: #455A64;">array</span><span style="color: #7388d6;">[</span>*<span style="color: #7388d6;">]</span><span style="color: #707183;">}</span>
</pre>
</div>

<p>
Para conocer el número de elementos del arreglo
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;">echo</span> $<span style="color: #707183;">{</span>#<span style="color: #455A64;">array</span><span style="color: #707183;">}</span>
</pre>
</div>

<div class="warning">
<p>
Los arreglos es un punto donde los diferentes <i>shells</i> ejecutan
diferente.
<code>bash</code> tiene índices basados en <code>0</code>, <code>zsh</code> en <code>1</code>.
</p>

</div>
</li>

<li><a id="orgf07dc9d"></a>Bucles de ejecución, (<i>Loops</i>)<br />
<p>
Los <code>for-loops</code> en <code>bash</code> tienen una estructura muy similar a los de
<code>python</code>:
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #bf360c;">for</span> var<span style="color: #bf360c;"> in</span> iterable; <span style="color: #bf360c;">do</span>
instrucci&#243;n
instrucci&#243;n
...
<span style="color: #bf360c;">done</span>
</pre>
</div>

<p>
Donde <code>iterable</code> puede construirse con <i>globs</i>
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #bf360c;">for</span> i<span style="color: #bf360c;"> in</span> *; <span style="color: #bf360c;">do</span>
  <span style="color: #795548;">echo</span> $<span style="color: #455A64;">i</span>;
<span style="color: #bf360c;">done</span>
</pre>
</div>

</section>
<section>
<p>
listas,
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #bf360c;">for</span> i<span style="color: #bf360c;"> in</span> hola adios mundo cruel; <span style="color: #bf360c;">do</span>
  <span style="color: #795548;">echo</span> $<span style="color: #455A64;">i</span>;
<span style="color: #bf360c;">done</span>
</pre>
</div>

<p>
arreglos,
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #bf360c;">for</span> i<span style="color: #bf360c;"> in</span> $<span style="color: #455A64;">array</span>; <span style="color: #bf360c;">do</span>
  <span style="color: #795548;">echo</span> $<span style="color: #455A64;">i</span>;
<span style="color: #bf360c;">done</span>
</pre>
</div>

</section>
<section>

<p>
E inclusive el horrible formato de <code>C</code>:
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #bf360c;">for</span> <span style="color: #707183;">(</span><span style="color: #7388d6;">(</span> <span style="color: #455A64;">i</span> = 0; i &lt; 10; i++ <span style="color: #7388d6;">)</span><span style="color: #707183;">)</span> <span style="color: #bf360c;">do</span>
    <span style="color: #795548;">echo</span> $<span style="color: #455A64;">i</span>;
<span style="color: #bf360c;">done</span>
</pre>
</div>

<div class="info">
<p>
También puedes escribirlo en una sola línea:  <code>for i in {a..z}; do echo $i; done</code>
</p>

</div>
</li>

<li><a id="org19a30b7"></a>Funciones<br />
<p>
Las funciones son símbolo de buena programación, ya que encapsulan
comportamiento.
</p>

<p>
La sintaxis es muy simple:
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #bf360c;">function</span> <span style="color: #388E3C;">function_name</span> <span style="color: #707183;">{</span>
    <span style="color: #795548;"># </span><span style="color: #795548;">cuerpo de la funci&#243;n</span>
<span style="color: #707183;">}</span>
</pre>
</div>

</section>
<section>

<p>
A diferencia de otros lenguajes de programación, no se definen los
argumentos de la función.
</p>

<p>
Para ejecutar la función
</p>

<div class="org-src-container">

<pre  class="src src-shell">function_name <span style="color: #6C3082;">"Hola mundo"</span> 123
</pre>
</div>

<p>
En este caso <code>"Hola mundo"</code> y <code>123</code> son pasados como argumentos a la
función. Estos pueden ser usados en el cuerpo de la función usando la
posición de los mismos e.g. <code>$1</code> es <code>"Hola mundo"</code>, <code>$2</code> es <code>123</code>, etc.
</p>
</li>


<li><a id="orga3496a3"></a>Ejecutar <i>scripts</i><br />
<p>
Para cualquier archivo <i>script</i> es importante que la primera línea del
archivo le diga al <code>shell</code>  que comando usar para ejecutarlo.
</p>

<p>
A la primera línea se conoce como <b>shebang</b> y se representa por <code>#!</code>
seguido de la ruta al ejecutable, e.g.:
</p>

<form><ul>
<li><code>#!/usr/bin/python</code>,</li>
<li><code>#!/bin/bash</code>,</li>
<li><code>#!/usr/bin/env Rscript</code>,</li>
<li>etc.</li>

</ul></form>


<p>
Sin el <code>shebang</code>, para ejecutar el archivo <code>ejemplo.py</code> debes de hacer:
</p>

<div class="org-src-container">

<pre  class="src src-shell">python ejemplo.py
</pre>
</div>

<p>
pero, si agregamos el <code>shebang</code> <sup><a id="fnr.19" class="footref" href="#fn.19">19</a></sup>, puedes ejecutar el archivo de
la siguiente manera:
</p>

<div class="org-src-container">

<pre  class="src src-shell">./ejemplo.py
</pre>
</div>

<p>
Te preguntarás ¿Cómo conecto estos <i>scripts</i> con los demás usando <code>|</code>, <code>&gt;</code>, etc?
</p>

<p>
Sencillo: Hay que modificar nuestros <i>scripts</i> de <code>python</code>, <code>R</code> y <code>bash</code> para
leer del <code>stdin</code>.
</p>
</li>

<li><a id="orgc2bf1b3"></a>Python, leyendo de <code>stdin</code><br />
<p>
Un ejemplo mínimo de <code>python</code> es el siguiente:
</p>

<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #795548;">#</span><span style="color: #795548;">!/usr/bin/env python</span>

<span style="color: #bf360c;">import</span> sys

<span style="color: #bf360c;">def</span> <span style="color: #388E3C;">process</span><span style="color: #707183;">(</span>linea<span style="color: #707183;">)</span>:
    <span style="color: #455A64;">linea</span> = <span style="color: #795548;">int</span><span style="color: #707183;">(</span>linea.strip<span style="color: #7388d6;">()</span><span style="color: #707183;">)</span>
    <span style="color: #bf360c;">print</span><span style="color: #707183;">(</span>f<span style="color: #6C3082;">"El triple de {linea} es {linea*3}"</span><span style="color: #707183;">)</span>

<span style="color: #bf360c;">for</span> linea <span style="color: #bf360c;">in</span> sys.stdin:
    process<span style="color: #707183;">(</span>linea<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Abre <code>nano</code>, copia este código y guarda el archivo como
<code>script.py</code>. Un ejemplo de uso es el que sigue:
</p>

<div class="org-src-container">

<pre  class="src src-shell">seq 1 1000 | script.py
</pre>
</div>
</li>


<li><a id="org2171055"></a>R, leyendo de <code>stdin</code><br />
<p>
El ejemplo en <code>R</code> se ve así:
</p>

<div class="org-src-container">

<pre  class="src src-R"><span style="color: #795548;">#</span><span style="color: #795548;">!/usr/bin/env Rscript</span>

f <span style="color: #0288D1;">&lt;-</span> file<span style="color: #707183;">(</span><span style="color: #6C3082;">"stdin"</span><span style="color: #707183;">)</span>

x <span style="color: #0288D1;">&lt;-</span> c<span style="color: #707183;">()</span>

open<span style="color: #707183;">(</span>f<span style="color: #707183;">)</span>

<span style="color: #bf360c;">while</span><span style="color: #707183;">(</span>length<span style="color: #7388d6;">(</span>line <span style="color: #0288D1;">&lt;-</span> readLines<span style="color: #909183;">(</span>f, n = 1<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span> &gt; 0<span style="color: #707183;">)</span> <span style="color: #707183;">{</span>

  x <span style="color: #0288D1;">&lt;-</span> c<span style="color: #7388d6;">(</span>x, as,numeric<span style="color: #909183;">(</span>line<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span>
  print<span style="color: #7388d6;">(</span>summary<span style="color: #909183;">(</span>x<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span>
<span style="color: #707183;">}</span>


close<span style="color: #707183;">(</span>f<span style="color: #707183;">)</span>

print<span style="color: #707183;">(</span><span style="color: #6C3082;">"Final summary:"</span><span style="color: #707183;">)</span>
summary<span style="color: #707183;">(</span>x<span style="color: #707183;">)</span>
</pre>
</div>

</section>
<section>

<p>
Ejemplo de uso:
</p>

<div class="org-src-container">

<pre  class="src src-shell">&lt; /data/numbers.txt script.R
</pre>
</div>
</li>
</ul>


</section>
</section>
<section>
<section id="slide-git">
<h3 id="git">Controlador de versiones <code>git</code></h3>
</section>
<section id="slide-org699c75d">
<h4 id="org699c75d"><i>"Solo" Workflow</i></h4>
<div class="outline-text-4" id="text-org699c75d">
</div>
<ul class="org-ul">
<li><a id="orgb484dbf"></a>Crear un repositorio<br />
<p>
El <b>repositorio</b> es la carpeta donde <code>git</code> guarda y gestiona todas
las versiones de los archivos.
</p>

<p>
Crea una carpeta en tu <code>$HOME</code> llamada <code>ds-test</code>, ingresa a
ella e inicializa el repositorio con <code>git init</code>. ¿Notas algún cambio?
¿Qué comando usarías? Hay una carpeta ahí ¿no la ves? ¿Cómo puedes ver
una carpeta oculta?
</p>

<p>
La carpeta <code>.git</code> es la carpeta donde se guarda todo el historial, si
la borras, toda la historia del repositorio se perderá.
</p>

<p>
Podemos verificar que todo esté bien, con el comando <code>status</code>.
</p>

<div class="org-src-container">

<pre  class="src src-shell">git status
</pre>
</div>
</li>

<li><a id="org4833a45"></a>Llevando registro de los cambios a archivo<br />
<p>
Crea un archivo llamado <code>hola.txt</code> en la carpeta <code>ds-test</code>
</p>

<div class="org-src-container">

<pre  class="src src-shell">touch hola.txt
<span style="color: #795548;">echo</span> <span style="color: #6C3082;">"&#161;hola mundo!"</span> &gt; hola.txt
</pre>
</div>

<p>
Ahora ejecuta el siguiente comando
</p>

<div class="org-src-container">

<pre  class="src src-shell">git status
</pre>
</div>

<p>
El mensaje de <code>untracked files</code> significa que hay archivos en el
repositorio de los cuales  <code>git</code> no está llevando registro, i.e. el
repositorio está <i>sucio</i>.
</p>

</section>
<section>

<p>
<code>Git</code> sigue este flujo:
</p>


<div class="figure">
<p><img src="images/git-solo.png" alt="git-solo.png" width="800px" height="600px" />
</p>
<p><span class="figure-number">Figure 1: </span>Git "solo workflow"</p>
</div>



</section>
<section>

<p>
Para que <code>git</code> lleve el registro (<i>tracking</i>) del archivo, debes de
<b>agregarlo</b> (<code>add</code>):
</p>

<div class="org-src-container">

<pre  class="src src-shell">git add hola.txt
git status
</pre>
</div>

</section>
<section>

<p>
Ahora <code>git</code> sabe que debe de llevar registro de los cambios de
<code>hola.txt</code>, pero aún se <b>comprometen</b> los cambios al repositorio
(<code>Changes to be commited: ...</code>). Para <i>comitearlos</i><sup><a id="fnr.20" class="footref" href="#fn.20">20</a></sup>:
</p>

<div class="org-src-container">

<pre  class="src src-shell">git commit -m <span style="color: #6C3082;">"Commit inicial"</span>
</pre>
</div>

<p>
Usamos la bandera <code>-m</code> para agregar un mensaje que nos ayude a
recordar más tarde que se hizo y por qué.
</p>

</section>
<section>

<p>
Si ejecutamos
</p>

<div class="org-src-container">

<pre  class="src src-shell">git status
</pre>
</div>

<p>
nos indica que todo está actualizado (<code>up to date</code>). Podemos ver la
historia de cambio con <code>git log</code>.
</p>

</section>
<section>

<p>
Edita <code>hola.txt</code> luego, ejecuta <code>git status</code>. ¿Qué observas ahora?
</p>

<p>
La parte clave es <code>no changes added to commit</code>. Hemos cambiado el
archivo, pero aún no están "comprometidas" o guardadas en el repositorio.
Para ver que ha cambiado usamos lo siguiente
</p>

<div class="org-src-container">

<pre  class="src src-shell"> git diff
</pre>
</div>

<p>
Hagamos <code>commit</code> de estos cambios.
</p>

</section>
<section>

<div class="org-src-container">

<pre  class="src src-shell">git commit -m <span style="color: #6C3082;">'actualizamos hola.txt'</span>
</pre>
</div>

<p>
Pero <code>git</code> no nos dejará hacer el <i>commit</i>, ya que no lo agregamos antes al índice del
repositorio. Agrégalo y repite el <code>commit</code>
</p>

</section>
<section>

<p>
Modifica de nuevo <code>hola.txt</code>. Observa los cambios y agrégalo. ¿Qué
sucede si vuelves a ejecutar <code>git diff</code>?
</p>

<p>
<code>Git</code> dice que no hay nada, ya que para <code>git</code> no hay diferencia entre
el área de <b>staging</b> y el último <b>commit</b> (llamado <code>HEAD</code>).
Para ver los cambios, ejecuta
</p>

<div class="org-src-container">

<pre  class="src src-shell"> git diff --staged
</pre>
</div>


<p>
esto muestra las diferencias entre los últimos cambios <b>comiteados</b> y
lo que está en el área de <b>staging</b>. Ahora realiza el <code>commit</code>, verifica
el estatus y revisa la historia.
</p>
</li>

<li><a id="org41200a1"></a>Explorando el pasado<br />
<p>
Podemos ver los cambios entre diferentes <b>revisiones</b>, podemos usar
la siguiente notación: <code>HEAD~1</code>, <code>HEAD~2</code>, etc. como sigue:
</p>

<div class="org-src-container">

<pre  class="src src-shell"> git diff HEAD~1 hola.txt
 git diff HEAD~2 hola.txt
</pre>
</div>

<p>
También podemos utilizar el identificador único (el número enorme que
aparece en el <code>git log</code>), inténtalo.
</p>

</section>
<section>

<p>
Modifiquemos de nuevo el archivo <code>hola.txt</code>. ¿Qué tal si nos
equivocamos y queremos regresar los cambios? Podemos ejecutar el
comando
</p>

<div class="org-src-container">

<pre  class="src src-shell">git checkout HEAD hola.txt
</pre>
</div>

<div class="info">
<p>
Nota que <code>git</code> recomienda un <b>shortcut</b> para esta operación: <code>(use
"git checkout -- &lt;file&gt;..." to discard changes in working directory)</code>)
</p>

</div>

<p>
Obviamente aquí podemos regresarnos las versiones que queramos, por lo
que podemos utilizar el identificador único o <code>HEAD~2</code> por ejemplo.
</p>

<p>
Por último, <code>git</code> tiene comandos <code>mv</code> y <code>rm</code> que deben de ser usados
cuando queremos mover o borrar un archivo del repositorio, i.e. <code>git
mv</code> y <code>git rm</code>.
</p>
</li>
</ul>

</section>
<section id="slide-org4a47c4a">
<h4 id="org4a47c4a"><i>Github flow</i></h4>
<p>
Ahora trabajaremos en equipo, el flujo cambia respecto al <i>solo
flow</i>. El cambio se debe a la introducción de nuevos conceptos:
<b>clonar</b>, <b>push/pull</b>, <b>issue</b> y <b>branch</b>.
</p>


<div class="figure">
<p><img src="images/git-flow.png" alt="git-flow.png" width="800px" height="600px" />
</p>
<p><span class="figure-number">Figure 2: </span>Github flow</p>
</div>


<p>
Para entender este diagrama, necesitamos explicar estos nuevos
<b>verbos</b>.
</p>

</section>
<section>

<p>
En <i>github flow</i> es muy importante que:
</p>

<form><ul>
<li>Crees <i>issues</i> y trabajes en ellos.</li>
<li>Idealmente un <i>issue</i> está relacionado con una sóla cosa (arreglar
algo, agregar algo)</li>
<li>Idealmente un <i>issue</i> debe de durar menos de 8 horas.</li>
<li>Hagas muchos <i>commits</i> al día</li>

</ul></form>

<div class="info">
<p>
Hacer  <i>commits</i>  frecuentemente permite que podamos hacer control de
versiones de manera granular. Si un <i>bug</i> aparece, podemos regresar a
versiones pasadas dónde el <i>bug</i> no existía.
</p>

<p>
Otra ventaja es que <i>commits</i> pequeños y frecuentes ayudan a tus
compañeros de trabajo (y tu futuro tú) entiendan mejor cuál es tu
intención.
</p>

</div>

<form><ul>
<li>¡Usa mensajes que tengan sentido!</li>

</ul></form>

</section>
<section>

<p>
En serio, escribe mensajes que tengan sentido
</p>


<div class="figure">
<p><img src="images/git_commit.png" alt="git_commit.png" width="800px" height="600px" />
</p>
<p><span class="figure-number">Figure 3: </span>Imagen de XKCD</p>
</div>

</section>
<section id="slide-org0169c3c">
<h4 id="org0169c3c">Ejercicio en equipo</h4>
<div class="outline-text-4" id="text-org0169c3c">
</div>
<ul class="org-ul">
<li><a id="org6273aa1"></a>Setup<br />
<form><ul>
<li>Cuatro personas por equipo, los llamaremos <b>A</b>, <b>B</b>, <b>C</b> y <b>D</b> en lo
que sigue.</li>
<li>Seleccionen a una persona para crear el repositorio, esta será <b>A</b></li>
<li><b>A</b> crea el repositorio <i>privado</i> en su cuenta de <a href="https://github.com">Github</a>, llamado <code>pds-2019</code>.</li>
<li><b>A</b> debe de agregar como <i>colaboradores</i> a <b>B</b>, <b>C</b> y <b>D</b>.</li>
<li><b>A</b> debe de agregarme (<code>@nanounanue</code>) como colaborador de <i>solo
lectura</i>.</li>
<li><b>A</b>, <b>B</b>, <b>C</b> y <b>D</b> deben de <i>clonar</i> el repositorio</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell">git clone https://github.com/usernameA/pds-2019.git /repositorios/pds-2019
</pre>
</div>
</li>

<li><a id="org4c91c96"></a>Interactuando<br />
<form><ul>
<li><b>A</b> crea el archivo <code>ml.py</code> (o <code>ml.R</code>) y agrega las siguientes 4
funciones vacías:

<form><ul>
<li><code>load_data</code>, <code>clean_data</code>, <code>store_data</code>, <code>run_ml_pipeline</code></li>

</ul></form></li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell">git add ml.py
git commit -m <span style="color: #6C3082;">"Pipeline de ML"</span>
git push origin master
</pre>
</div>


<form><ul>
<li><b>B</b>, <b>C</b> y <b>D</b> hagan <code>pull</code> para obtener los cambios más recientes.</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell">git pull origin master
</pre>
</div>

<form><ul>
<li><b>TODOS</b> vean lo cambios con <code>git status</code>, <code>git log</code></li>

</ul></form>

</section>
<section>

<form><ul>
<li><b>TODOS</b>: Repártanse el trabajo y cada uno cree uno de los 4 <i>issues</i>
en github con el título <i>Completar función</i> <code>...</code> donde <code>...</code> es el
nombre de la función.</li>
<li><b>TODOS</b>: En su <i>virtual machine</i>, creen un nuevo <i>branch</i>:</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell">git checkout -b issue-N
</pre>
</div>

<p>
donde <code>N</code> es el número de <i>issue</i> correspondiente.
</p>

<form><ul>
<li><b>TODOS</b>: Verifica que ahora estás en un nuevo <i>branch</i>:</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell">git branch
</pre>
</div>

</section>
<section>

<form><ul>
<li><b>TODOS</b>: completen sus funciones y creen un <i>pull-request</i>, asignen
a un <code>reviewer</code> a uno de sus compañeros. Asígnen el <i>pull-request</i> a
ustedes mismos. El mensaje del <i>pull-request</i> debe de ser <code>Closes
  #N</code>.</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;"># </span><span style="color: #795548;">En el branch correspondiente (i.e. issue-N)</span>
git add ml.py
git commit -m <span style="color: #6C3082;">"Completada la funci&#243;n XXXX"</span> <span style="color: #795548;">#</span><span style="color: #795548;">Donde XXX es el nombre de la funci&#243;n</span>
git push origin issue-M
</pre>
</div>

<form><ul>
<li><b>TODOS</b>: El <i>reviewer</i> debe de solicitar un cambio. El responsable
del <i>pull-request</i> debe de modificarlo en su laptop y hacer <code>push</code>
de nuevo. Agrega un comentario en el <i>thread</i> de comunicación del
<i>pull-request</i>.</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;"># </span><span style="color: #795548;">La persona encargada del PR ...</span>
<span style="color: #795548;"># </span><span style="color: #795548;">En el branch correspondiente (i.e. issue-N)</span>
git add ml.py
git commit -m <span style="color: #6C3082;">"Incorporando los cambios del reviewer"</span> <span style="color: #795548;">#</span><span style="color: #795548;">Donde XXX es el nombre de la funci&#243;n</span>
git push origin issue-M
</pre>
</div>

</section>
<section>

<form><ul>
<li><b>TODOS</b> El <i>reviewer</i> acepta los cambios.</li>
<li><b>TODOS</b> El responsable hace <i>merge</i> del <i>pullrequest</i> a
<code>master</code>. Borra el <i>branch</i> remoto y bórralo localmente.</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #795548;"># </span><span style="color: #795548;">En la computadora del encargado del PR ...</span>
git checkout master
git branch -D issue-N
</pre>
</div>

</section>
<section>

<form><ul>
<li><b>TODOS</b> Cambien a <code>master</code> localmente y actualicen su versión local
con <code>pull</code>.</li>

</ul></form>

<div class="org-src-container">

<pre  class="src src-shell">git checkout master
git pull origin master
</pre>
</div>

<form><ul>
<li><b>TODOS</b> Verifiquen que <code>Github</code> y sus versiones locales están sincronizadas.</li>
<li><b>TODOS</b> Festeja con tus compañeros de equipo que llegaron hasta el final.</li>

</ul></form>
</li>
</ul>


</section>
</section>
<section>
<section id="slide-programming">
<h3 id="programming">Desarrollo de software</h3>
</section>
<section id="slide-orgdf94116">
<h4 id="orgdf94116">Un consejo</h4>
<blockquote>
<p>
"The way to learn to program is by programming"
</p>

<p>
Nathan Myhrvold
</p>
</blockquote>

</section>
<section id="slide-org915d7ca">
<h4 id="org915d7ca">El código es para comunicarse con humanos</h4>
<p>
<b>NOTE</b>: Los <i>slides</i> siguientes están basados en el trabajo de Kevin
Wilson (<code>@khwilson</code>)
</p>

<blockquote>
<p>
El <b>código</b> es para humanos, no para computadoras.
</p>
</blockquote>

</section>
<section id="slide-orgd9479d6">
<h4 id="orgd9479d6">Lo que escribes</h4>
<aside class="notes">
<p>
Here is an example of a function. Why write this function? Well,
literally, you give the function an integer <b>n</b>, and the function
gives you back the *n*th Fibonnaci number. Writing code allows you to
have the computer calculate the <b>n*th Fibonnaci number, which it can
probably do much faster than you can, especially as *n</b> gets larger
and larger. It also allows your human comrades to see for themselves
how you rattle off arbitrary Fibonacci numbers so fast. But you don't
really write code for the computer&#x2026;
</p>

</aside>

<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">fib</span><span style="color: #707183;">(</span>n<span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">"""</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">param</span><span style="color: #6C3082;"> </span><span style="color: #455A64;">int n</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The Fibonnaci index you want to return</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The nth Fibonnaci number</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> int</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #bf360c;">if</span> n &lt; 2:
        <span style="color: #bf360c;">return</span> 1
    <span style="color: #bf360c;">else</span>:
        <span style="color: #bf360c;">return</span> fib<span style="color: #707183;">(</span>n - 1<span style="color: #707183;">)</span> + fib<span style="color: #707183;">(</span>n - 2<span style="color: #707183;">)</span>
</pre>
</div>

</section>
<section id="slide-orgdceb0d4">
<h4 id="orgdceb0d4">Lo que la computadora ve</h4>
<div class="org-src-container">

<pre  class="src src-:eval">  2           0 LOAD_FAST                0 (n)
              3 LOAD_CONST               1 (2)
              6 COMPARE_OP               0 (&lt;)
              9 POP_JUMP_IF_FALSE       16
  3          12 LOAD_CONST               2 (1)
             15 RETURN_VALUE
  5     &gt;&gt;   16 LOAD_GLOBAL              0 (fib)
             19 LOAD_FAST                0 (n)
             22 LOAD_CONST               2 (1)
             25 BINARY_SUBTRACT
             26 CALL_FUNCTION            1
             29 LOAD_GLOBAL              0 (fib)
             32 LOAD_FAST                0 (n)
             35 LOAD_CONST               1 (2)
             38 BINARY_SUBTRACT
             39 CALL_FUNCTION            1
             42 BINARY_ADD
             43 RETURN_VALUE
             44 LOAD_CONST               0 (None)
             47 RETURN_VALUE
</pre>
</div>

</section>
<section id="slide-org5096127">
<h4 id="org5096127">En serio, es para ti</h4>
<form><ul>
<li>&#x2026; dentro de un mes, habrás olvidado completamente en que era esa
&alpha; &#x2026;</li>
<li>&#x2026;o mañana, tu compañero de trabajo se preguntará que son todos
esos <code>3s</code> en la base de datos &#x2026;</li>
<li>&#x2026;o cuando el sistema esté colapsando a las 2 am (la hora de las
brujas en sistemas puestos en producción), y tú estés cansado, y tu
jefe y clientes estén llamándote para saber que demonios está
pasando &#x2026;</li>
<li>Por eso, debes de comunicarte contigo y con tus compañeros humanos</li>

</ul></form>

</section>
<section id="slide-orga48a5ff">
<h4 id="orga48a5ff">Da nombres informativos</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">import</span> math

<span style="color: #bf360c;">def</span> <span style="color: #388E3C;">doit</span><span style="color: #707183;">(</span>x<span style="color: #707183;">)</span>:
    <span style="color: #455A64;">output</span> = <span style="color: #707183;">[]</span>
    <span style="color: #455A64;">y</span> = 2
    <span style="color: #bf360c;">while</span> x != 1:
        <span style="color: #bf360c;">if</span> x % y == 0:
            output.append<span style="color: #707183;">(</span>y<span style="color: #707183;">)</span>
            <span style="color: #455A64;">x</span> //= y
        <span style="color: #bf360c;">else</span>:
            <span style="color: #455A64;">y</span> += 1
            <span style="color: #bf360c;">continue</span>
    <span style="color: #bf360c;">return</span> output
</pre>
</div>

</section>
<section id="slide-org66e52e0">
<h4 id="org66e52e0">Da nombres informativos</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">magic</span><span style="color: #707183;">(</span><span style="color: #795548;">input</span><span style="color: #707183;">)</span>:
    <span style="color: #795548;">filter</span> = <span style="color: #795548;">set</span><span style="color: #707183;">()</span>
    <span style="color: #bf360c;">return</span> <span style="color: #795548;">sorted</span><span style="color: #707183;">(</span>x <span style="color: #bf360c;">for</span> x <span style="color: #bf360c;">in</span> y
                    <span style="color: #bf360c;">for</span> y <span style="color: #bf360c;">in</span> <span style="color: #795548;">input</span>
                    <span style="color: #bf360c;">if</span> <span style="color: #7388d6;">(</span><span style="color: #795548;">len</span><span style="color: #909183;">(</span>x<span style="color: #909183;">)</span> &lt; 20 <span style="color: #bf360c;">and</span> x <span style="color: #bf360c;">not</span> <span style="color: #bf360c;">in</span> <span style="color: #795548;">filter</span><span style="color: #7388d6;">)</span> <span style="color: #bf360c;">or</span> <span style="color: #795548;">filter</span>.add<span style="color: #7388d6;">(</span>x<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>


</section>
<section id="slide-org9afaa76">
<h4 id="org9afaa76">Da nombres informativos</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">pretty_pictures</span><span style="color: #707183;">()</span>:
    <span style="color: #455A64;">df</span> = pd.read_csv<span style="color: #707183;">(</span><span style="color: #6C3082;">'2016.csv.gz'</span>, names=<span style="color: #7388d6;">[</span><span style="color: #6C3082;">'STATION'</span>, <span style="color: #6C3082;">'DATE'</span>, <span style="color: #6C3082;">'TYPE'</span>, <span style="color: #6C3082;">'VALUE'</span>,
                                           <span style="color: #6C3082;">'MEASUREMENT_FLAG'</span>, <span style="color: #6C3082;">'QUALITY_FLAG'</span>,
                                           <span style="color: #6C3082;">'SOURCE_FLAG'</span>, <span style="color: #6C3082;">'OBS_TIME'</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
    <span style="color: #455A64;">first</span> = df<span style="color: #707183;">[</span>weather_df.STATION == <span style="color: #6C3082;">'US1ILCK0010'</span><span style="color: #707183;">]</span>
    first<span style="color: #707183;">[</span>first.TYPE == <span style="color: #6C3082;">'PRCP'</span><span style="color: #707183;">][</span><span style="color: #6C3082;">'VALUE'</span><span style="color: #707183;">]</span>.plot<span style="color: #707183;">()</span>
    plt.title<span style="color: #707183;">(</span><span style="color: #6C3082;">"Precipitation values"</span><span style="color: #707183;">)</span>
    plt.xlabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Day"</span><span style="color: #707183;">)</span>
    plt.ylabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Value"</span><span style="color: #707183;">)</span>
    plt.savefig<span style="color: #707183;">(</span><span style="color: #6C3082;">'first_fig.png'</span><span style="color: #707183;">)</span>

    <span style="color: #455A64;">second</span> = df<span style="color: #707183;">[</span>weather_df.STATION == <span style="color: #6C3082;">'US1ILCK0014'</span><span style="color: #707183;">]</span>
    second<span style="color: #707183;">[</span>second.TYPE == <span style="color: #6C3082;">'PRCP'</span><span style="color: #707183;">][</span><span style="color: #6C3082;">'VALUE'</span><span style="color: #707183;">]</span>.plot<span style="color: #707183;">()</span>
    plt.title<span style="color: #707183;">(</span><span style="color: #6C3082;">"Precipitation values"</span><span style="color: #707183;">)</span>
    plt.xlabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Day"</span><span style="color: #707183;">)</span>
    plt.ylabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Value"</span><span style="color: #707183;">)</span>
    plt.savefig<span style="color: #707183;">(</span><span style="color: #6C3082;">'second_fig.png'</span><span style="color: #707183;">)</span>

    <span style="color: #bf360c;">return</span> first<span style="color: #707183;">[</span>first.TYPE == <span style="color: #6C3082;">'PRCP'</span><span style="color: #707183;">]</span>.mean<span style="color: #707183;">()</span>, second<span style="color: #707183;">[</span>second.TYPE == <span style="color: #6C3082;">'PRCP'</span><span style="color: #707183;">]</span>.mean<span style="color: #707183;">()</span>
</pre>
</div>

</section>
<section id="slide-org778d5be">
<h4 id="org778d5be">Da nombres informativos</h4>
<form><ul>
<li>Los nombres deben de tener <i>significado</i> para los lectores de tú código, e.g.
<form><ul>
<li>Tú en una semana</li>
<li>Tus compañeros mañana</li>
<li>Tus compañeros del futuro que heredarán tu código</li>

</ul></form></li>

<li>\(i\), \(j\), \(k\) para <i>algunos</i> <b>iteradores</b> está bien, pero &alpha; que hace
referencia a un artículo en específico, NO.</li>
<li><code>kwargs</code> es un gran lugar para nombrar cosas (<code>python</code>)</li>
<li><code>CONSTANTES</code></li>
<li>No le temas a nombres largos; tienes <code>autocomplete</code></li>

</ul></form>

</section>
<section id="slide-org084e76d">
<h4 id="org084e76d">Documenta entradas y salidas</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">import</span> math

<span style="color: #bf360c;">def</span> <span style="color: #388E3C;">factor</span><span style="color: #707183;">(</span>x<span style="color: #707183;">)</span>:
    <span style="color: #455A64;">output</span> = <span style="color: #707183;">[]</span>
    <span style="color: #455A64;">fact</span> = 2
    <span style="color: #bf360c;">while</span> x != 1:
        <span style="color: #bf360c;">if</span> x % fact == 0:
            output.append<span style="color: #707183;">(</span>y<span style="color: #707183;">)</span>
            <span style="color: #455A64;">x</span> //= fact
        <span style="color: #bf360c;">else</span>:
            <span style="color: #455A64;">fact</span> += 1
            <span style="color: #bf360c;">continue</span>
    <span style="color: #bf360c;">return</span> output
</pre>
</div>

</section>
<section id="slide-orgbc0a487">
<h4 id="orgbc0a487">Documenta entradas y salidas</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">unique_flatten</span><span style="color: #707183;">(</span>the_input, max_length=20<span style="color: #707183;">)</span>:
    <span style="color: #455A64;">flattened_set</span> = <span style="color: #707183;">{</span>val <span style="color: #bf360c;">for</span> val <span style="color: #bf360c;">in</span> row <span style="color: #bf360c;">for</span> row <span style="color: #bf360c;">in</span> the_input<span style="color: #707183;">}</span>
    <span style="color: #455A64;">filtered_list</span> = <span style="color: #707183;">[</span>val <span style="color: #bf360c;">for</span> val <span style="color: #bf360c;">in</span> flattened_set <span style="color: #bf360c;">if</span> <span style="color: #795548;">len</span><span style="color: #7388d6;">(</span>val<span style="color: #7388d6;">)</span> &lt; max_length<span style="color: #707183;">]</span>
    filtered_list.sort<span style="color: #707183;">()</span>
    <span style="color: #bf360c;">return</span> filtered_list
</pre>
</div>

</section>
<section id="slide-org6146bb0">
<h4 id="org6146bb0">Documenta entradas y salidas</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #455A64;">WEATHER_HEADERS</span> = <span style="color: #707183;">[</span><span style="color: #6C3082;">'STATION'</span>, <span style="color: #6C3082;">'DATE'</span>, <span style="color: #6C3082;">'TYPE'</span>, <span style="color: #6C3082;">'VALUE'</span>,
                   <span style="color: #6C3082;">'MEASUREMENT_FLAG'</span>, <span style="color: #6C3082;">'QUALITY_FLAG'</span>,
                   <span style="color: #6C3082;">'SOURCE_FLAG'</span>, <span style="color: #6C3082;">'OBS_TIME'</span><span style="color: #707183;">]</span>

<span style="color: #455A64;">PRECIPITATION_TYPE</span> = <span style="color: #6C3082;">'PRCP'</span>
<span style="color: #455A64;">CHICAGO_STATION_NAMES</span> = <span style="color: #707183;">[</span><span style="color: #6C3082;">'US1ILCK0010'</span>, <span style="color: #6C3082;">'US1ILCK0014'</span><span style="color: #707183;">]</span>

<span style="color: #bf360c;">def</span> <span style="color: #388E3C;">precipitation_in_chicago</span><span style="color: #707183;">()</span>:
    <span style="color: #455A64;">df</span> = pd.read_csv<span style="color: #707183;">(</span><span style="color: #6C3082;">'2016.csv.gz'</span>, names=WEATHER_HEADERS<span style="color: #707183;">)</span>
    <span style="color: #455A64;">first</span> = df<span style="color: #707183;">[</span>weather_df.STATION == CHICAGO_STATION_NAMES<span style="color: #7388d6;">[</span>0<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
    first<span style="color: #707183;">[</span>first.TYPE == PRECIPITATION_TYPE<span style="color: #707183;">][</span><span style="color: #6C3082;">'VALUE'</span><span style="color: #707183;">]</span>.plot<span style="color: #707183;">()</span>
    plt.title<span style="color: #707183;">(</span><span style="color: #6C3082;">"Precipitation values"</span><span style="color: #707183;">)</span>
    plt.xlabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Day"</span><span style="color: #707183;">)</span>
    plt.ylabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Value"</span><span style="color: #707183;">)</span>
    plt.savefig<span style="color: #707183;">(</span><span style="color: #6C3082;">'first_fig.png'</span><span style="color: #707183;">)</span>

    <span style="color: #455A64;">second</span> = df<span style="color: #707183;">[</span>weather_df.STATION == CHICAGO_STATION_NAMES<span style="color: #707183;">]</span>
    second<span style="color: #707183;">[</span>second.TYPE == PRECIPITATION_TYPE<span style="color: #707183;">][</span><span style="color: #6C3082;">'VALUE'</span><span style="color: #707183;">]</span>.plot<span style="color: #707183;">()</span>
    plt.title<span style="color: #707183;">(</span><span style="color: #6C3082;">"Precipitation values"</span><span style="color: #707183;">)</span>
    plt.xlabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Day"</span><span style="color: #707183;">)</span>
    plt.ylabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Value"</span><span style="color: #707183;">)</span>
    plt.savefig<span style="color: #707183;">(</span><span style="color: #6C3082;">'second_fig.png'</span><span style="color: #707183;">)</span>

    <span style="color: #bf360c;">return</span> <span style="color: #707183;">(</span>first<span style="color: #7388d6;">[</span>first.TYPE == PRECIPITATION_TYPE<span style="color: #7388d6;">]</span>.mean<span style="color: #7388d6;">()</span>,
            second<span style="color: #7388d6;">[</span>second.TYPE == PRECIPITATION_TYPE<span style="color: #7388d6;">]</span>.mean<span style="color: #7388d6;">()</span><span style="color: #707183;">)</span>
</pre>
</div>

</section>
<section id="slide-org6d279a6">
<h4 id="org6d279a6">Documenta entradas y salidas</h4>
<form><ul>
<li>Cada función debe de tener un <i>docstring</i></li>
<li>Los <i>docstring</i> <b>deben</b> de
<form><ul>
<li>Describir la función <i>brevemente</i></li>
<li>Explícitamente documentar las entradas con <code>:param type name: description</code></li>
<li>Explícitamente documantar el valor de retorno con <code>:returns: description</code></li>
<li>Explícitamente documentar el tipo del retorno con <code>:rtype:</code></li>

</ul></form></li>

</ul></form>

</section>
<section id="slide-org1b8911a">
<h4 id="org1b8911a">En <code>python 3.6</code> : <i>Static type checking</i></h4>
<p>
En versiones recientes de <code>python</code> es posible <i>indicar</i> el tipo de las
variables:
</p>

<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">from</span> typing <span style="color: #bf360c;">import</span> Dict

<span style="color: #bf360c;">def</span> <span style="color: #388E3C;">do_ml_magic</span><span style="color: #707183;">(</span>algorithm: <span style="color: #795548;">str</span>, hyperparams: Dict<span style="color: #707183;">)</span> -&gt; Model:
    ...

    train_date: <span style="color: #455A64;">date</span> = ...

    model: <span style="color: #455A64;">Model</span> =  ...

    <span style="color: #bf360c;">return</span> model
</pre>
</div>

<p>
Estas adiciones son <i>sugerencias</i>, es decir son estáticas. Puedes
verificar tu  código con <code>mypy</code> o con tu editor (como GNU Emacs o PyCharm)
</p>


</section>
<section id="slide-orgf9739c0">
<h4 id="orgf9739c0"><i>Don't repeat yourself: DRY</i></h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">max_intersection</span><span style="color: #707183;">(</span>left, right<span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">"""</span>
<span style="color: #6C3082;">    Compute the value counts of the left and right lists and then return</span>
<span style="color: #6C3082;">    the maximum for each value.</span>

<span style="color: #6C3082;">    :param list[object] left: The left list</span>
<span style="color: #6C3082;">    :param list[object] right: The right list</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> dict[object, int]</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> A dictionary from the value to</span>
<span style="color: #6C3082;">        max(# occurrences in left, # occurrences in right)</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #455A64;">left_counts</span> = <span style="color: #707183;">{}</span>
    <span style="color: #bf360c;">for</span> val <span style="color: #bf360c;">in</span> left:
        <span style="color: #bf360c;">if</span> left <span style="color: #bf360c;">not</span> <span style="color: #bf360c;">in</span> left_counts:
            <span style="color: #455A64;">left_counts</span><span style="color: #707183;">[</span>val<span style="color: #707183;">]</span> = 1
        <span style="color: #bf360c;">else</span>:
            <span style="color: #455A64;">left_counts</span><span style="color: #707183;">[</span>val<span style="color: #707183;">]</span> += 1

    <span style="color: #455A64;">right_counts</span> = <span style="color: #707183;">{}</span>
    <span style="color: #bf360c;">for</span> val <span style="color: #bf360c;">in</span> right:
        <span style="color: #bf360c;">if</span> right <span style="color: #bf360c;">not</span> <span style="color: #bf360c;">in</span> right_counts:
            <span style="color: #455A64;">right_counts</span><span style="color: #707183;">[</span>val<span style="color: #707183;">]</span> = 1
        <span style="color: #bf360c;">else</span>:
            <span style="color: #455A64;">right_counts</span><span style="color: #707183;">[</span>val<span style="color: #707183;">]</span> += 1

    left_counts.update<span style="color: #707183;">(</span><span style="color: #7388d6;">{</span>key: <span style="color: #795548;">max</span><span style="color: #909183;">(</span>left_counts.get<span style="color: #709870;">(</span>key, 0<span style="color: #709870;">)</span>, val<span style="color: #909183;">)</span>
                        <span style="color: #bf360c;">for</span> key, val <span style="color: #bf360c;">in</span> right_counts.items<span style="color: #909183;">()</span><span style="color: #7388d6;">}</span><span style="color: #707183;">)</span>
    <span style="color: #bf360c;">return</span> left_counts
</pre>
</div>

<aside class="notes">
<p>
En este caso, la lógica de conteo es redundante y puede ser abstraída
en una función.
</p>

</aside>

</section>
<section id="slide-orgfde349b">
<h4 id="orgfde349b">DRY (o a otros!)</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">value_counts</span><span style="color: #707183;">(</span>the_list<span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">"""</span>
<span style="color: #6C3082;">    :param list[object] the_list: The list whose values we'll count</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> dict[object, int]</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> A dict from the value to its count</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #455A64;">output</span> = <span style="color: #707183;">{}</span>
    <span style="color: #bf360c;">for</span> val <span style="color: #bf360c;">in</span> the_list:
        <span style="color: #bf360c;">if</span> val <span style="color: #bf360c;">not</span> <span style="color: #bf360c;">in</span> output:
            <span style="color: #455A64;">output</span><span style="color: #707183;">[</span>val<span style="color: #707183;">]</span> = 1
        <span style="color: #bf360c;">else</span>:
            <span style="color: #455A64;">output</span><span style="color: #707183;">[</span>val<span style="color: #707183;">]</span> += 1

<span style="color: #bf360c;">def</span> <span style="color: #388E3C;">max_intersection</span><span style="color: #707183;">(</span>left, right<span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">"""</span>
<span style="color: #6C3082;">    Compute the value counts of the left and right lists and then return</span>
<span style="color: #6C3082;">    the maximum for each value.</span>

<span style="color: #6C3082;">    :param list[object] left: The left list</span>
<span style="color: #6C3082;">    :param list[object] right: The right list</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> dict[object, int]</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> A dictionary from the value to</span>
<span style="color: #6C3082;">        max(# occurrences in left, # occurrences in right)</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #455A64;">left_counts</span> = value_counts<span style="color: #707183;">(</span>left<span style="color: #707183;">)</span>
    <span style="color: #455A64;">right_counts</span> = value_counts<span style="color: #707183;">(</span>right<span style="color: #707183;">)</span>

    left_counts.update<span style="color: #707183;">(</span><span style="color: #7388d6;">{</span>key: <span style="color: #795548;">max</span><span style="color: #909183;">(</span>left_counts.get<span style="color: #709870;">(</span>key, 0<span style="color: #709870;">)</span>, val<span style="color: #909183;">)</span>
                        <span style="color: #bf360c;">for</span> key, val <span style="color: #bf360c;">in</span> right_counts.items<span style="color: #909183;">()</span><span style="color: #7388d6;">}</span><span style="color: #707183;">)</span>
    <span style="color: #bf360c;">return</span> left_counts
</pre>
</div>

<aside class="notes">
<p>
Mucho mejor &#x2026; pero no hay necesidad de inventar la rueda de nuevo
con la función <code>value_count</code> si ya ha sido implementada para ti
</p>

</aside>

</section>
<section id="slide-org37d786b">
<h4 id="org37d786b">DRY (solución)</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">from</span> collections <span style="color: #bf360c;">import</span> Counter

<span style="color: #bf360c;">def</span> <span style="color: #388E3C;">max_intersection</span><span style="color: #707183;">(</span>left, right<span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">"""</span>
<span style="color: #6C3082;">    Compute the value counts of the left and right lists and then return</span>
<span style="color: #6C3082;">    the maximum for each value.</span>

<span style="color: #6C3082;">    :param list[object] left: The left list</span>
<span style="color: #6C3082;">    :param list[object] right: The right list</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> dict[object, int]</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> A dictionary from the value to</span>
<span style="color: #6C3082;">        max(# occurrences in left, # occurrences in right)</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #455A64;">left_counts</span> = Counter<span style="color: #707183;">(</span>left<span style="color: #707183;">)</span>
    <span style="color: #455A64;">right_counts</span> = Counter<span style="color: #707183;">(</span>right<span style="color: #707183;">)</span>

    left_counts.update<span style="color: #707183;">(</span><span style="color: #7388d6;">{</span>key: <span style="color: #795548;">max</span><span style="color: #909183;">(</span>left_counts.get<span style="color: #709870;">(</span>key, 0<span style="color: #709870;">)</span>, val<span style="color: #909183;">)</span>
                        <span style="color: #bf360c;">for</span> key, val <span style="color: #bf360c;">in</span> right_counts.items<span style="color: #909183;">()</span><span style="color: #7388d6;">}</span><span style="color: #707183;">)</span>
    <span style="color: #bf360c;">return</span> left_counts
</pre>
</div>

</section>
<section id="slide-org6311469">
<h4 id="org6311469"><i>no DRY, WET</i></h4>
<aside class="notes">
<p>
He aquí un ejemplo de una función que hace <i>plots</i>. Lo que está bien:
Hay un <i>docstring</i>, tiene un nombre más o menos informativo. Lo que
está mal: La función hace muchas cosas y  tiene un <code>path</code> <i>hardcoded</i>
(<code>2016.csv.gz</code>)
</p>

</aside>

<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">precipitation_in_chicago</span><span style="color: #707183;">()</span>:
    <span style="color: #6C3082;">""" Saves plots of the precipitation from two Chicago weather stations</span>
<span style="color: #6C3082;">    in 2016 to `first_fig.png` and `second_fig.png` and returns the mean</span>
<span style="color: #6C3082;">    precipitation at them for the year.</span>

<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The mean precipitation at two weather stations in 2016</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> (float, float)</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #455A64;">df</span> = pd.read_csv<span style="color: #707183;">(</span><span style="color: #6C3082;">'2016.csv.gz'</span>, names=WEATHER_HEADERS<span style="color: #707183;">)</span>
    <span style="color: #455A64;">first</span> = df<span style="color: #707183;">[</span>weather_df.STATION == CHICAGO_STATION_NAMES<span style="color: #7388d6;">[</span>0<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
    first<span style="color: #707183;">[</span>first.TYPE == PRECIPITATION_TYPE<span style="color: #707183;">][</span><span style="color: #6C3082;">'VALUE'</span><span style="color: #707183;">]</span>.plot<span style="color: #707183;">()</span>
    plt.title<span style="color: #707183;">(</span><span style="color: #6C3082;">"Precipitation values"</span><span style="color: #707183;">)</span>
    plt.xlabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Day"</span><span style="color: #707183;">)</span>
    plt.ylabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Value"</span><span style="color: #707183;">)</span>
    plt.savefig<span style="color: #707183;">(</span><span style="color: #6C3082;">'first_fig.png'</span><span style="color: #707183;">)</span>

    <span style="color: #455A64;">second</span> = df<span style="color: #707183;">[</span>weather_df.STATION == CHICAGO_STATION_NAMES<span style="color: #7388d6;">[</span>1<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
    second<span style="color: #707183;">[</span>second.TYPE == PRECIPITATION_TYPE<span style="color: #707183;">][</span><span style="color: #6C3082;">'VALUE'</span><span style="color: #707183;">]</span>.plot<span style="color: #707183;">()</span>
    plt.title<span style="color: #707183;">(</span><span style="color: #6C3082;">"Precipitation values"</span><span style="color: #707183;">)</span>
    plt.xlabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Day"</span><span style="color: #707183;">)</span>
    plt.ylabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Value"</span><span style="color: #707183;">)</span>
    plt.savefig<span style="color: #707183;">(</span><span style="color: #6C3082;">'second_fig.png'</span><span style="color: #707183;">)</span>

    <span style="color: #bf360c;">return</span> <span style="color: #707183;">(</span>first<span style="color: #7388d6;">[</span>first.TYPE == PRECIPITATION_TYPE<span style="color: #7388d6;">]</span>.mean<span style="color: #7388d6;">()</span>,
            second<span style="color: #7388d6;">[</span>second.TYPE == PRECIPITATION_TYPE<span style="color: #7388d6;">]</span>.mean<span style="color: #7388d6;">()</span><span style="color: #707183;">)</span>
</pre>
</div>

</section>
<section id="slide-orgc2f5dc2">
<h4 id="orgc2f5dc2">DRY</h4>
<aside class="notes">
<p>
En este ejemplo, hemos hecho una funcipón auziliar. También, la
función tiene un mejor nombre, no carga el <i>dataframe</i> en la función,
y el <i>docstring</i> especifica que las entradas, salidas y sus tipos.
</p>

</aside>

<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">plot_precipitation</span><span style="color: #707183;">(</span>df, station_id, output_file=<span style="color: #6C3082;">'out.png'</span><span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">""" Plot the preciptation at the passed weather station and return</span>
<span style="color: #6C3082;">    the mean precipitation among all values.</span>

<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">param</span><span style="color: #6C3082;"> </span><span style="color: #455A64;">pd.DataFrame df</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> NOAA data (see parsers.py for more info)</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">param</span><span style="color: #6C3082;"> </span><span style="color: #455A64;">str station_id</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The station to plot</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">param</span><span style="color: #6C3082;"> </span><span style="color: #455A64;">str output_file</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> Where to store the output plot</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The mean precipitation in the data frame</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> float</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #455A64;">res_df</span> = df<span style="color: #707183;">[</span>df.STATION == station_id<span style="color: #707183;">]</span>
    res_df<span style="color: #707183;">[</span>res_df.TYPE == PRECIPITATION_TYPE<span style="color: #707183;">][</span><span style="color: #6C3082;">'VALUE'</span><span style="color: #707183;">]</span>.plot<span style="color: #707183;">()</span>
    plt.title<span style="color: #707183;">(</span><span style="color: #6C3082;">"Precipitation values"</span><span style="color: #707183;">)</span>
    plt.xlabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Day"</span><span style="color: #707183;">)</span>
    plt.ylabel<span style="color: #707183;">(</span><span style="color: #6C3082;">"Value"</span><span style="color: #707183;">)</span>
    plt.savefig<span style="color: #707183;">(</span>output_file<span style="color: #707183;">)</span>

    <span style="color: #bf360c;">return</span> res_df<span style="color: #707183;">[</span><span style="color: #6C3082;">'VALUE'</span><span style="color: #707183;">]</span>.mean<span style="color: #707183;">()</span>


<span style="color: #bf360c;">def</span> <span style="color: #388E3C;">precipitation_in_chicago</span><span style="color: #707183;">()</span>:
    <span style="color: #6C3082;">""" Saves plots of the precipitation from two Chicago weather stations</span>
<span style="color: #6C3082;">    in 2016 to `first_fig.png` and `second_fig.png` and returns the mean</span>
<span style="color: #6C3082;">    precipitation at them for the year.</span>

<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The mean precipitation at two weather stations in 2016</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> (float, float)</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #455A64;">df</span> = pd.read_csv<span style="color: #707183;">(</span><span style="color: #6C3082;">'2016.csv.gz'</span>, names=WEATHER_HEADERS<span style="color: #707183;">)</span>
    <span style="color: #bf360c;">return</span> <span style="color: #707183;">(</span>plot_precipitation<span style="color: #7388d6;">(</span>df, CHICAGO_STATION_NAMES<span style="color: #909183;">[</span>0<span style="color: #909183;">]</span>, output_file=<span style="color: #6C3082;">'first_fig.png'</span><span style="color: #7388d6;">)</span>,
            plot_precipitation<span style="color: #7388d6;">(</span>df, CHICAGO_STATION_NAMES<span style="color: #909183;">[</span>1<span style="color: #909183;">]</span>, output_file=<span style="color: #6C3082;">'second_fig.png'</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

</section>
<section id="slide-orga9341d1">
<h4 id="orga9341d1">DRY</h4>
<form><ul>
<li>Usa funciones para no repetirte a ti mismo</li>
<li>Regla de dedo: Si llevas 20 líneas de código sin hacer ningún
comentario (e.g. un <i>docstring</i>) probablemente debas de agregar uno</li>

</ul></form>

</section>
<section id="slide-org7957373">
<h4 id="org7957373">Reduce la carga cognitiva: PEP-8</h4>
<aside class="notes">
<p>
¿Cuánto tiempo te toma entender que es lo que está haciendo estas funciones?
</p>

</aside>

<form><ol>
<li></li>

</ol></form>

<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">GCD</span><span style="color: #707183;">(</span>a,b<span style="color: #707183;">)</span>:
   <span style="color: #6C3082;">"""Return the GCD of a and b"""</span>
   <span style="color: #455A64;">a</span>,<span style="color: #455A64;">b</span>=<span style="color: #795548;">max</span><span style="color: #707183;">(</span>a,b<span style="color: #707183;">)</span>,<span style="color: #795548;">min</span><span style="color: #707183;">(</span>a,b<span style="color: #707183;">)</span>
   <span style="color: #bf360c;">return</span> b <span style="color: #bf360c;">if</span> a%b==0 <span style="color: #bf360c;">else</span> GCD<span style="color: #707183;">(</span>b,a%b<span style="color: #707183;">)</span>
</pre>
</div>

<form><ol>
<li></li>

</ol></form>

<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">gcd</span><span style="color: #707183;">(</span>a, b<span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">"""Return the GCD of a and b</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">param</span><span style="color: #6C3082;"> </span><span style="color: #455A64;">int a</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The first number (positive)</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">param</span><span style="color: #6C3082;"> </span><span style="color: #455A64;">int b</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The second number (positive)</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The GCD of a and b</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> int</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #bf360c;">if</span> a &lt; b:
        <span style="color: #455A64;">b</span>, <span style="color: #455A64;">a</span> = a, b
    <span style="color: #bf360c;">if</span> a % b:
        <span style="color: #bf360c;">return</span> gcd<span style="color: #707183;">(</span>b, a%b<span style="color: #707183;">)</span>
    <span style="color: #bf360c;">return</span> b
</pre>
</div>


</section>
<section id="slide-orgbd6d743">
<h4 id="orgbd6d743">¿Qué hace a esta implementación mejor?</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">gcd</span><span style="color: #707183;">(</span>a, b<span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">"""Return the GCD of a and b</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">param</span><span style="color: #6C3082;"> </span><span style="color: #455A64;">int a</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The first number (positive)</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">param</span><span style="color: #6C3082;"> </span><span style="color: #455A64;">int b</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The second number (positive)</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">return</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> The GCD of a and b</span>
<span style="color: #6C3082;">    </span><span style="color: #bf360c;">:</span><span style="color: #3f51b5;">rtype</span><span style="color: #bf360c;">:</span><span style="color: #6C3082;"> int</span>
<span style="color: #6C3082;">    """</span>
    <span style="color: #bf360c;">if</span> a &lt; b:
        <span style="color: #455A64;">b</span>, <span style="color: #455A64;">a</span> = a, b
    <span style="color: #bf360c;">if</span> a % b:
        <span style="color: #bf360c;">return</span> gcd<span style="color: #707183;">(</span>b, a%b<span style="color: #707183;">)</span>
    <span style="color: #bf360c;">return</span> b
</pre>
</div>

</section>
<section id="slide-orge88eec7">
<h4 id="orge88eec7">PEP-8</h4>
<form><ul>
<li>79 caracteres por línea</li>
<li><code>nombres_de_funcion</code> en <code>snake_case</code></li>
<li><code>NombresDeClase</code> en <code>CamelCase</code></li>
<li><code>CONSTANTES</code> en <code>MAYÚSCULAS</code></li>
<li>Una instrucción por línea</li>
<li>Usa espacios, no <i>tabs</i>!</li>

</ul></form>

</section>
<section id="slide-orgab27ce6">
<h4 id="orgab27ce6">Puedes usar PEP-8 de manera automática</h4>
<p>
Instala <code>autopep8</code>
</p>
<div class="org-src-container">

<pre  class="src src-shell">pip install autopep8
</pre>
</div>

<div class="org-src-container">

<pre  class="src src-shell">autopep8 --in-place mi_archivo.py
</pre>
</div>

</section>
<section id="slide-orgad8783d">
<h4 id="orgad8783d">O de manera manual</h4>
<div class="org-src-container">

<pre  class="src src-shell">pip install flake8
</pre>
</div>

<div class="org-src-container">

<pre  class="src src-shell">flake8 mi_archivo.py
</pre>
</div>

</section>
<section id="slide-org05cab3e">
<h4 id="org05cab3e">La única regla de programación</h4>
<blockquote>
<p>
Codificas para comunicarte con humanos, no computadoras
</p>
</blockquote>

<form><ul>
<li>Da nombres informativos a las cosas (funciones, variables, clases,
bloques, etc)</li>
<li>Documenta las entradas y salidas</li>
<li>No te repitas a ti mismo o a otros</li>
<li><code>PEP-8</code> es tu amigo</li>

</ul></form>

</section>
<section id="slide-org3541a44">
<h4 id="org3541a44">Arregla esta clase</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">class</span> <span style="color: #3f51b5;">myclass</span><span style="color: #707183;">(</span><span style="color: #795548;">object</span><span style="color: #707183;">)</span>:
    <span style="color: #bf360c;">def</span> <span style="color: #388E3C;">__init__</span><span style="color: #707183;">(</span><span style="color: #bf360c;">self</span>, R, I<span style="color: #707183;">)</span>:
        <span style="color: #bf360c;">self</span>.R = R
        <span style="color: #bf360c;">self</span>.I = I

    <span style="color: #bf360c;">def</span> <span style="color: #388E3C;">Multiply</span><span style="color: #707183;">(</span><span style="color: #bf360c;">self</span>, other<span style="color: #707183;">)</span>:
        <span style="color: #bf360c;">return</span> myclass<span style="color: #707183;">(</span><span style="color: #bf360c;">self</span>.R * other.R - <span style="color: #bf360c;">self</span>.I * other.I,
                       <span style="color: #bf360c;">self</span>.R * other.I + <span style="color: #bf360c;">self</span>.I * other.R<span style="color: #707183;">)</span>
</pre>
</div>

</section>
<section id="slide-org021a1eb">
<h4 id="org021a1eb">Arregla esta función</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">bang</span><span style="color: #707183;">(</span>n<span style="color: #707183;">)</span>:
    <span style="color: #bf360c;">return</span> n == 1 <span style="color: #bf360c;">or</span> <span style="color: #707183;">(</span>n * bang<span style="color: #7388d6;">(</span>n<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

</section>
<section id="slide-org1e7bfb0">
<h4 id="org1e7bfb0">Arregla esta función</h4>
<div class="org-src-container">

<pre  class="src src-jupyter-python"><span style="color: #bf360c;">def</span> <span style="color: #388E3C;">read_data</span><span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span>:
    <span style="color: #6C3082;">""" Return the precipitation field from the csv passed in """</span>
    <span style="color: #bf360c;">with</span> <span style="color: #795548;">open</span><span style="color: #707183;">(</span>filename, <span style="color: #6C3082;">'r'</span><span style="color: #707183;">)</span> <span style="color: #bf360c;">as</span> f:
        <span style="color: #bf360c;">return</span> <span style="color: #707183;">[</span>line.split<span style="color: #7388d6;">(</span><span style="color: #6C3082;">','</span><span style="color: #7388d6;">)[</span>2<span style="color: #7388d6;">]</span> <span style="color: #bf360c;">for</span> line <span style="color: #bf360c;">in</span> f<span style="color: #707183;">]</span>
</pre>
</div>


</section>
<section id="slide-orgf0422ba">
<h4 id="orgf0422ba">Paradigmas de programación</h4>
<div class="outline-text-4" id="text-orgf0422ba">
</div>
<ul class="org-ul">
<li><a id="orge843567"></a>Procedural<br />
<p>
La unidad más importante para diseñar es el <b>verbo</b>. La lógica guiada
por los verbos se coloca dentro de <i>funciones</i> , <i>procedimientos</i> o <i>subrutinas</i>.
</p>

<p>
Si decides esta opción para programar, lo que tienes que hacer es que
tu código siga una serie <b>secuencial</b> de pasos.
</p>

<p>
Suena obvio ¿Cierto? Pero esta decisión tendrá los siguientes efectos:
</p>

<form><ul>
<li>La salida de una función no necesariamente tiene una correlación
directa con la entrada</li>
<li>Todo se tiene que hacer en un orden específico</li>
<li>La ejecución de la rutina tendrá efectos laterales (<i>side effects</i>)</li>
<li>La solución se tiende a implementar de forma lineal.</li>

</ul></form>
</li>

<li><a id="org6e3c10a"></a>Orientado a Objetos<br />
<p>
Cuando diseñas la solución a un problema usando este paradigma te
enfocas en los <b>sustantivos</b> en lugar de los verbos. Cada sustantivo
se mapeará a un <i>objeto</i>.
</p>

<p>
Los objetos contienen la información sobre su estado (<i>state</i>) y su
comportamiento (<i>behavior</i>).
</p>

<p>
El estado de un objeto queda descrito por las características del
mismo, es decir, qué palabras usarías para describirlo. Para
identificar el estado buscarás relaciones tiene (<i>has</i>) o es (<i>is a</i>)
en la descripción del problema. El estado de un objeto se programará
en variables llamadas <i>atributos</i>.
</p>

<p>
Comportamientos es aquello que el objeto puede hacer, la lógica de
este comportamiento se codifica en <i>métodos</i>. Regularmente los nombres
de los métodos se ponen en infinitivo: <code>correr</code>, <code>beber</code>, etc.
</p>
</li>


<li><a id="orgb2bed7a"></a>Funcional<br />
<p>
Idealmente, un lenguaje <i>funcional</i> permite escribir funciones
matemáticas, es decir funciones que tienen \(n\) argumentos y regresan
un valor. Las funciones matemáticas, siempre regresan el mismo valor si la
función es aplicada en los mismos argumentos.
</p>

<p>
Los impactos más importantes de este paradigma son:
</p>

<form><ul>
<li>Siempre devuelven el mismo valor para una entrada dada</li>
<li>El orden de evaluación <b>no</b> está definido</li>
<li>No hay un estado (<i>stateless</i>)</li>
<li>Son fácilmente paralelizables</li>

</ul></form>
</li>
</ul>






</section>
<section id="slide-orgbce5536">
<h4 id="orgbce5536">Diseñar una solución: <a href="https://lukepalmer.wordpress.com/2008/07/18/semantic-design/"><i>Semantic design</i></a></h4>
<form><ul>
<li>Los <i>tipos</i> y <i>objetos</i> de tu programa <i>deben de significar algo</i></li>

<li>El dominio semántico debe de ser modular (<i>composable</i>)</li>

<li>El dominio semántico debe de ser tan simple como sea posible.</li>

</ul></form>


</section>
</section>
<section>
<section id="slide-sql">
<h3 id="sql">Bases de datos</h3>
</section>
<section id="slide-org8597652">
<h4 id="org8597652">RDBMS: Bases de datos relacionales</h4>
<p>
En la década de 1970, <a href="https://en.wikipedia.org/wiki/Edgar_F._Codd">Edward F. Codd</a>, desarrolló, usando las
matemáticas del <i><a href="https://en.wikipedia.org/wiki/Relational_algebra">álgebra relacional</a></i><sup><a id="fnr.21" class="footref" href="#fn.21">21</a></sup>, el modelo de bases de datos
conocidas como RDBMS.
</p>

<p>
Por simplicidad, a las RDBMS las llamaremos <i>bases de datos</i>.
</p>

</section>
<section>

<p>
Las bases de datos relacionales contienen <i>relaciones</i> (tablas), las
cuales tienen un conjunto de <i>tuplas</i>
(renglones), las cuales mapean <i>atributos</i> a valores atómicos, los
cuales quedan definidos por una <i>tupla header</i> mapeado a un <i>dominio</i>
(columnas).
</p>

<p>
Originalmente booleanas, la implementación actual es logica trivaluada
(<code>TRUE</code>, <code>FALSE</code>, <code>NULL</code>).
</p>

<p>
El lenguaje usado para manipular datos se conoce como <code>SQL</code>.
</p>

</section>
<section>

<p>
Ejemplos de  bases de datos relacionales son:
</p>

<form><ul>
<li>sqlite</li>
<li>MySQL</li>
<li>PostgreSQL</li>
<li>Microsoft SQL Server</li>
<li>Oracle</li>
<li>IBM DB2</li>
<li>Teradata</li>
<li>&#x2026;</li>

</ul></form>

</section>
<section id="slide-org590eb3a">
<h4 id="org590eb3a">Ventajas</h4>
<p>
Las ventajas de la utilización de una base de datos son las siguientes:
</p>

<form><ul>
<li>Es posible manejar volúmenes de datos más grandes que memoria.</li>
<li>Velocidad de acceso a los datos</li>
<li>Facilidad de manipulación con lenguajes relacionales (i.e. <code>SQL</code>)</li>
<li>Colaboración
<form><ul>
<li>Varias personas pueden accesar a los datos</li>
<li>Estas personas no tienen por qué usar el mismo lenguaje (!)</li>

</ul></form></li>

</ul></form>

</section>
<section id="slide-org98038b5">
<h4 id="org98038b5"><i>Data model</i></h4>
<p>
Un modelo de datos (<i>data model</i>) es una colección de conceptos que
describen los datos.
</p>

<p>
La descripción de una colección particular de datos usando el <i>modelo de datos</i>
se conoce como <i>esquema</i>, la cual, en las RDBMS incluye nombre de los
atributos, tipo, restricciones, reglas de negocio, etc.
</p>

<aside class="notes">
<p>
Discutir sobre <i>Datawarehouses</i>, <i>datamarts</i>, Kimball vs Inmon,
Entidad-evento, <i>data lakes</i> etc
</p>

</aside>

</section>
<section id="slide-org38d1603">
<h4 id="org38d1603">ACID</h4>
<p>
Las bases de datos relacionales, satisfacen las propiedades conocidas
como <b>ACID</b>:
</p>

<form><dl>
<dt>atomicidad</dt><dd>Todo el trabajo de una transacción o se completa en su totalidad
(<code>commit</code>) o <i>nada</i> del trabajo se completa.</dd>
<dt>consistencia</dt><dd>Cada transacción transforma la base de datos de un
estado consistente a otro estado consistente.</dd>
<dt>aislado (<i>isolated</i>)</dt><dd>Los resultados de los cambios realizados en
una transacción no son visibles hasta que la transacción es <i>committed</i>.</dd>
<dt>durable</dt><dd>Los cambios resultantes de una transacción sobreviven a fallas.</dd>

</dl></form>

</section>
<section id="slide-org048fc16">
<h4 id="org048fc16">Ejemplo: <code>sqlite</code></h4>
<p>
<code>SQLite</code> es una base de datos relacional y local. No requiere manejo
de usuarios, así que puedes inmediatamente a usarla. En tu <code>vagrant</code> teclea:
</p>

<div class="org-src-container">

<pre  class="src src-shell">sqlite3 turista.db
</pre>
</div>

</section>
<section>

<p>
Este comando crea una <i>base de datos</i>  que se vivirá en el archivo <code>turista.db</code>
</p>

<p>
Puedes ver las tablas dentro de la base de datos <code>turista.db</code>
</p>

<div class="org-src-container">

<pre  class="src src-sql">.tables
</pre>
</div>

</section>
<section>

<p>
Para salir teclea <code>Ctrl+d</code>. Si quieres volver a entrar a la base de
datos, teclea de nuevo
</p>

<div class="org-src-container">

<pre  class="src src-shell">sqlite3 turista.db
</pre>
</div>

</section>
<section id="slide-orgd48e771">
<h4 id="orgd48e771">Ejemplo: <code>PostgreSQL</code> y <code>psql</code></h4>
<p>
<code>PostgreSQL</code> (o simplemente <code>postgres</code>) es una de las bases
de datos relacionales más poderosas disponibles.
</p>

<p>
Entre las ventajas de <code>Postgresql</code> están:
</p>

<form><ul>
<li>Open-source</li>
<li>Varios tipos de <a href="https://www.postgresql.org/docs/current/indexes.html">índices</a></li>
<li>5 tipos diferentes de <code>joins</code></li>
<li><i>subqueries</i> en cualquier cláusula</li>
<li><i>Window functions</i></li>
<li>Soporte geoespacial</li>
<li><i>queries</i> recursivos</li>
<li>Tipos de datos como <code>XML</code>, <code>json</code>, arreglos &#x2026;</li>
<li>Extensible:lenguajes externos, puedes crear tipos de datos,
funciones, agregadores, operadores, etc.</li>
<li><i>foreign data wrappers</i></li>
<li>Creación concurrente de índices</li>
<li><i>queries</i> en paralelo</li>
<li>Listen/notify</li>

</ul></form>




<p>
<code>psql</code> es su cliente de la base de datos.
</p>




</section>
<section>

<p>
Primero debemos de crear una <i>base de datos</i><sup><a id="fnr.22" class="footref" href="#fn.22">22</a></sup> y para hacerlo
debes de ser el administrador del servidor <b>RDBMS</b>. Por <i>default</i> el
usuario es <code>postgres</code>.
</p>

<div class="org-src-container">

<pre  class="src src-shell">sudo su postgres
</pre>
</div>

</section>
<section>

<p>
El <i>prompt</i> de vagrant debió de cambiar a algo como
</p>

<div class="org-src-container">

<pre  class="src src-shell">postgres@ubuntu1904:/home/vagrant$
</pre>
</div>

<aside class="notes">
<p>
Puedes comprobar que eres <code>postgres</code> con el comando <code>whoami</code>
</p>

</aside>

<p>
Teclea <code>psql</code> para iniciar el cliente de base de datos.
</p>

<div class="org-src-container">

<pre  class="src src-shell">psql
</pre>
</div>

<p>
El <i>prompt</i> debería de cambiar de nuevo:
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #455A64;">postgres</span>=#
</pre>
</div>

</section>
<section>

<p>
Iniciemos creando la base de datos <code>turista</code>:
</p>

<div class="org-src-container">

<pre  class="src src-sql"><span style="color: #bf360c;">create</span> database turista;
</pre>
</div>

<p>
<code>psql</code> está lleno de pequeños atajos que puedes consultar con <code>\?</code>,
por ejemplo, para ver las bases de datos creadas
</p>

<div class="org-src-container">

<pre  class="src src-sql">\l
</pre>
</div>

</section>
<section>

</section>
<section>

<p>
Acto seguido, creemos un usuario<sup><a id="fnr.23" class="footref" href="#fn.23">23</a></sup>, llamado <code>turista</code> y asignémosle (<code>GRANT</code>) todos los
privilegios en la base de datos <code>turista</code>
</p>

<div class="org-src-container">

<pre  class="src src-sql"><span style="color: #bf360c;">create</span> <span style="color: #bf360c;">role</span> turista login ; <span style="color: #795548;">-- Permitimos que el rol se pueda conectar</span>
<span style="color: #bf360c;">alter</span> <span style="color: #bf360c;">role</span> turista <span style="color: #bf360c;">with</span> encrypted password <span style="color: #6C3082;">'some_password'</span>; <span style="color: #795548;">-- Agregamos un password</span>
<span style="color: #bf360c;">grant</span> <span style="color: #bf360c;">all</span> <span style="color: #bf360c;">privileges</span> <span style="color: #bf360c;">on</span> database turista <span style="color: #bf360c;">to</span> turista; <span style="color: #795548;">-- Asignamos privilegios en la bd turista</span>
</pre>
</div>


<p>
Puedes ver los roles en el servidor <code>PostgreSQL</code> mediante
</p>

<div class="org-src-container">

<pre  class="src src-sql">\du+
</pre>
</div>

</section>
<section>

<p>
Teclea <code>Ctrl+d</code> (para salir de <code>psql</code>) y luego <code>Ctrl+d</code> (para salir
de la sesión del usuario <code>postgres</code>). Con la base de datos creada es
posible conectarte desde la sesión del usuario <code>vagrant</code>
</p>

<div class="org-src-container">

<pre  class="src src-shell">psql -U turista -d turista -h 0.0.0.0 -W
</pre>
</div>

<p>
La sintaxis es la siguiente:
</p>

<div class="org-src-container">

<pre  class="src src-shell">psql -h host -U user -d base_de_datos -W
</pre>
</div>

</section>
<section>

<div class="info">
<p>
Para evitar que pregunte la contraseña, creen un archivo <code>.pgpass</code> en el <code>$HOME</code> con la siguiente sintaxis:
</p>

<div class="org-src-container">

<pre  class="src src-shell">host:port:*:username:password
</pre>
</div>

<p>
El archivo debe de ser visible sólo para el usuario <code>vagrant</code> por lo
que hay que guardarlo con permisos <code>0600</code>:
</p>

<div class="org-src-container">

<pre  class="src src-shell">chmod 0600 .pgpass
</pre>
</div>

<p>
Otra adición que hará tu vida fácil, es tener un archivo
<code>.pg_service_conf</code>
</p>

<div class="org-src-container">

<pre  class="src src-shell"><span style="color: #707183;">[</span>turista<span style="color: #707183;">]</span>
<span style="color: #455A64;">host</span>=0.0.0.0
<span style="color: #455A64;">port</span>=5432
<span style="color: #455A64;">user</span>=turista
</pre>
</div>

</div>

</section>
<section>

<p>
Si quieres ejecutar un archivo <code>.sql</code> (lo necesitaremos más adelante):
</p>


<div class="org-src-container">

<pre  class="src src-shell">psql -f script.sql
</pre>
</div>

</section>
<section>

<p>
También es posible ejecutar un comando <code>SQL</code> (muy útil en <i>scripts</i> de <code>bash</code>)
</p>

<div class="org-src-container">

<pre  class="src src-shell">psql -d turista -c <span style="color: #6C3082;">"SELECT * from pg_tables limit 1;"</span>
</pre>
</div>

</section>
<section id="slide-org7abd5cb">
<h4 id="org7abd5cb">SQL</h4>
<p>
<code>SQL</code> puede ser dividido en <code>DDL</code> y <code>DML</code>.
</p>

<p>
<i>Data definition language</i> (DDL)  es usado para cambiar el esquema de
la base de datos, i.e. crear y destruir tablas, cambiar (alterar)
columnas, etc.
</p>

<p>
Por su parte <i>Data manipulation language</i> (DML) se usa para consultar
las tablas y para modificar los renglones de una tabla:
insertar, borrar, modificar.
</p>

<ul class="org-ul">
<li><a id="org0476c3f"></a>Ingestar datos<br />
<p>
Si ya existe una tabla con el mismo esquema que <code>archivo.csv</code> el
siguiente comando sube el archivo a la tabla
</p>

<div class="org-src-container">

<pre  class="src src-sql">\copy tabla1 <span style="color: #bf360c;">from</span> <span style="color: #6C3082;">'archivo.csv'</span> <span style="color: #bf360c;">with</span> delimiter <span style="color: #6C3082;">','</span> csv header;
</pre>
</div>
</li>


<li><a id="org3a492ce"></a><code>SQL</code><br />
<p>
<code>SQL</code> es un lenguaje <i>lógico</i>, es decir, no le decimos a la
computadora (en este caso al RDBMS) <b>como</b> debe proceder paso a paso
para obtener nuestro resultado deseado (como en un lenguaje imperativo
como <code>python</code> o <code>R</code>), al contrario, le especificamos
el resultado (lo que queremos) y el RDBMS debe de averiguar/calcular
por si mismo los pasos para obtenerlo<sup><a id="fnr.24" class="footref" href="#fn.24">24</a></sup>.
</p>

<p>
Dicho esto, la manera en la que construyes el <i>query</i> es describiendo
lo que quieres, no como lo obtienes:
</p>
</li>

<li><a id="orgd3a5fcb"></a><code>SELECT</code><br />
<p>
<code>SELECT</code> es usado (no hay sorpresa aquí) para seleccionar datos de la
base de datos. Los datos obtenidos son almacenados en una tabla (todo
son tablas) llamada <i>result set</i>.
</p>

<p>
En su forma más sencilla:
</p>

<div class="org-src-container">

<pre  class="src src-sql"><span style="color: #bf360c;">SELECT</span> &lt;atributos&gt;
<span style="color: #bf360c;">FROM</span> &lt;una o m&#225;s relaciones&gt;
<span style="color: #bf360c;">WHERE</span> &lt;condiciones&gt;
</pre>
</div>

</section>
<section>

<p>
En su forma completa:
</p>

<div class="org-src-container">

<pre  class="src src-sql"><span style="color: #bf360c;">SELECT</span> <span style="color: #bf360c;">DISTINCT</span> <span style="color: #bf360c;">column</span>, AGG_FUNC<span style="color: #707183;">(</span>column_or_expression<span style="color: #707183;">)</span>, &#8230;
<span style="color: #bf360c;">FROM</span> mytable
    <span style="color: #bf360c;">JOIN</span> another_table
      <span style="color: #bf360c;">ON</span> mytable.<span style="color: #bf360c;">column</span> = another_table.<span style="color: #bf360c;">column</span>
    <span style="color: #bf360c;">WHERE</span> constraint_expression
    <span style="color: #bf360c;">GROUP</span> <span style="color: #bf360c;">BY</span> <span style="color: #bf360c;">column</span>
    <span style="color: #bf360c;">HAVING</span> constraint_expression
    <span style="color: #bf360c;">ORDER</span> <span style="color: #bf360c;">BY</span> <span style="color: #bf360c;">column</span> <span style="color: #bf360c;">ASC</span>/<span style="color: #bf360c;">DESC</span>
    <span style="color: #bf360c;">LIMIT</span> <span style="color: #795548;">count</span>;
</pre>
</div>
</li>

<li><a id="org59d918b"></a><code>SELECT</code> orden de ejecución<br />
<p>
Aunque el orden de ejecución no es de arriba hacia abajo (como en un
lenguaje imperativo), es algo un <i>poco</i> más complicado:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">paso</th>
<th scope="col" class="org-left">instrucción</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">5</td>
<td class="org-left">SELECT</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">DISTINCT column, AGG_FUNC(column_or_expression), …</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">FROM mytable</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">JOIN another_table</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">ON mytable.column = another_table.column</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">WHERE constraint_expression</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">GROUP BY column</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">HAVING constraint_expression</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-left">ORDER BY column ASC/DESC</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-left">LIMIT count;</td>
</tr>
</tbody>
</table>
</li>

<li><a id="orgcb0cae9"></a>Exportar datos<br />
<p>
Ahora que entendemos  como seleccionar datos desde nuestra base de
datos, podemos usar la combinación de <code>\copy</code>  y <code>select</code> para
exportar datos hacia afuera de la <i>base de datos</i>.
</p>

<div class="org-src-container">

<pre  class="src src-sql">\copy <span style="color: #707183;">(</span><span style="color: #bf360c;">select</span> columns <span style="color: #bf360c;">from</span> table1 <span style="color: #bf360c;">where</span> conditions<span style="color: #707183;">)</span> <span style="color: #bf360c;">to</span> <span style="color: #6C3082;">'archivo.psv'</span> <span style="color: #bf360c;">with</span> delimiter <span style="color: #6C3082;">'|'</span> csv header;
</pre>
</div>
</li>

<li><a id="org9f87f5b"></a>Modificar: Insertar, borrar, actualizar<br />
<form><ul>
<li>insertar</li>

</ul></form>

<pre class="example">
insert into r(a1,...., an) values (v1,...., vn);
</pre>

<form><ul>
<li>borrar</li>

</ul></form>

<pre class="example">
delete from t
where a1 = value;
</pre>

<form><ul>
<li>Actualizar</li>

</ul></form>

<pre class="example">
update t
set a1 = 'algo' where condiciones;
</pre>
</li>
</ul>
</div>
</div>
<p> Basado en: </p>
<script src="http://cdn.jsdelivr.net/reveal.js/3.0.0/lib/js/head.min.js"></script>
<script src="http://cdn.jsdelivr.net/reveal.js/3.0.0/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: false,
hashOneBasedIndex: false,
pdfSeparateFragments: true,

overview: true,
width: 1920,
height: 1080,
margin: 0.10,
minScale: 1.00,
maxScale: 1.00,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'fade', // see README of reveal.js for options
transitionSpeed: 'fast',
controlsTutorial: false, controlsLayout: 'edges',

// Optional libraries used to extend reveal.js
dependencies: [
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } }]

});
</script>
</body>
</html>
